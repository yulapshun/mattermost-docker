webpackJsonp([49],{2122:function(e,a,t){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(a,"__esModule",{value:!0});var l=t(6),m=s(l),i=t(4),n=s(i),d=t(5),r=s(d),o=t(7),u=s(o),c=t(8),f=s(c),g=t(2),h=s(g),p=t(1),v=s(p),E=t(17),b=t(437),_=t(2089),j=function(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t]);return a.default=e,a}(_),M=t(137),N=s(M),y=t(240),F=s(y),S=t(238),k=s(S),w=t(242),C=s(w),I=function(e){function a(e){(0,n.default)(this,a);var t=(0,u.default)(this,(a.__proto__||(0,m.default)(a)).call(this,e));return t.handleSubmit=t.handleSubmit.bind(t),t.updateName=t.updateName.bind(t),t.updateImage=t.updateImage.bind(t),t.state={name:"",image:null,imageUrl:"",saving:!1,error:null},t}return(0,f.default)(a,e),(0,r.default)(a,[{key:"handleSubmit",value:function(e){var a=this;if(e.preventDefault(),!this.state.saving){this.setState({saving:!0,error:null});var t={creator_id:this.props.user.id,name:this.state.name.trim().toLowerCase()};return t.name.startsWith(":")&&t.name.endsWith(":")&&(t.name=t.name.substring(1,t.name.length-1)),t.name?/[^a-z0-9_-]/.test(t.name)?void this.setState({saving:!1,error:v.default.createElement(E.FormattedMessage,{id:"add_emoji.nameInvalid",defaultMessage:"An emoji's name can only contain lowercase letters, numbers, and the symbols '-' and '_'."})}):N.default.hasSystemEmoji(t.name)?void this.setState({saving:!1,error:v.default.createElement(E.FormattedMessage,{id:"add_emoji.nameTaken",defaultMessage:"This name is already in use by a system emoji. Please choose another name."})}):this.state.image?void j.addEmoji(t,this.state.image,function(){a.context.router.push("/"+a.props.team.name+"/emoji")},function(e){a.setState({saving:!1,error:e.message})}):void this.setState({saving:!1,error:v.default.createElement(E.FormattedMessage,{id:"add_emoji.imageRequired",defaultMessage:"An image is required for the emoji"})}):void this.setState({saving:!1,error:v.default.createElement(E.FormattedMessage,{id:"add_emoji.nameRequired",defaultMessage:"A name is required for the emoji"})})}}},{key:"updateName",value:function(e){this.setState({name:e.target.value})}},{key:"updateImage",value:function(e){var a=this;if(0===e.target.files.length)return void this.setState({image:null,imageUrl:""});var t=e.target.files[0],s=new FileReader;s.onload=function(){a.setState({image:t,imageUrl:s.result})},s.readAsDataURL(t)}},{key:"render",value:function(){var e=null;this.state.image&&(e=v.default.createElement("span",{className:"add-emoji__filename"},this.state.image.name));var a=null;return this.state.imageUrl&&(a=v.default.createElement("div",{className:"form-group"},v.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"preview"},v.default.createElement(E.FormattedMessage,{id:"add_emoji.preview",defaultMessage:"Preview"})),v.default.createElement("div",{className:"col-md-5 col-sm-8 add-emoji__preview"},v.default.createElement(E.FormattedMessage,{id:"add_emoji.preview.sentence",defaultMessage:"This is a sentence with {image} in it.",values:{image:v.default.createElement("span",{className:"emoticon",style:{backgroundImage:"url("+this.state.imageUrl+")"}})}})))),v.default.createElement("div",{className:"backstage-content row"},v.default.createElement(F.default,null,v.default.createElement(b.Link,{to:"/"+this.props.team.name+"/emoji"},v.default.createElement(E.FormattedMessage,{id:"emoji_list.header",defaultMessage:"Custom Emoji"})),v.default.createElement(E.FormattedMessage,{id:"add_emoji.header",defaultMessage:"Add"})),v.default.createElement("div",{className:"backstage-form"},v.default.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},v.default.createElement("div",{className:"form-group"},v.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"name"},v.default.createElement(E.FormattedMessage,{id:"add_emoji.name",defaultMessage:"Name"})),v.default.createElement("div",{className:"col-md-5 col-sm-8"},v.default.createElement("input",{id:"name",type:"text",maxLength:"64",className:"form-control",value:this.state.name,onChange:this.updateName}),v.default.createElement("div",{className:"form__help"},v.default.createElement(E.FormattedMessage,{id:"add_emoji.name.help",defaultMessage:"Choose a name for your emoji made of up to 64 characters consisting of lowercase letters, numbers, and the symbols '-' and '_'."})))),v.default.createElement("div",{className:"form-group"},v.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"image"},v.default.createElement(E.FormattedMessage,{id:"add_emoji.image",defaultMessage:"Image"})),v.default.createElement("div",{className:"col-md-5 col-sm-8"},v.default.createElement("div",null,v.default.createElement("div",{className:"add-emoji__upload"},v.default.createElement("button",{className:"btn btn-primary"},v.default.createElement(E.FormattedMessage,{id:"add_emoji.image.button",defaultMessage:"Select"})),v.default.createElement("input",{type:"file",accept:".jpg,.png,.gif",multiple:!1,onChange:this.updateImage})),e,v.default.createElement("div",{className:"form__help"},v.default.createElement(E.FormattedMessage,{id:"add_emoji.image.help",defaultMessage:"Choose the image for your emoji. The image can be a gif, png, or jpeg file with a max size of 64 KB and dimensions up to 128 by 128 pixels."}))))),a,v.default.createElement("div",{className:"backstage-form__footer"},v.default.createElement(k.default,{type:"backstage",error:this.state.error}),v.default.createElement(b.Link,{className:"btn btn-sm",to:"/"+this.props.team.name+"/emoji"},v.default.createElement(E.FormattedMessage,{id:"add_emoji.cancel",defaultMessage:"Cancel"})),v.default.createElement(C.default,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,onClick:this.handleSubmit},v.default.createElement(E.FormattedMessage,{id:"add_emoji.save",defaultMessage:"Save"}))))))}}]),a}(v.default.Component);I.propTypes={team:h.default.object,user:h.default.object},I.contextTypes={router:h.default.object.isRequired},a.default=I}});
//# sourceMappingURL=49.d0808aeb10be35a35689.js.map