{"version":3,"sources":["webpack:///52.22bd7bc5d4bcf0a40072.js","webpack:///./components/create_team/components/team_url.jsx"],"names":["webpackJsonp","2110","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_stringify","_stringify2","_getPrototypeOf","_getPrototypeOf2","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_propTypes","_propTypes2","_react","_react2","_reactBootstrap","_reactDom","_reactDom2","_reactIntl","_diagnostics_actions","_team_actions","_constants","_constants2","_url","URL","newObj","key","prototype","hasOwnProperty","call","_logo","_logo2","TeamUrl","_React$Component","props","this","_this","__proto__","submitBack","bind","submitNext","handleFocus","state","nameError","isLoading","trackEvent","e","preventDefault","wizard","updateParent","_this2","name","findDOMNode","refs","trim","cleanedName","cleanUpUrlable","urlRegex","setState","createElement","FormattedMessage","id","defaultMessage","length","MIN_TEAMNAME_LENGTH","MAX_TEAMNAME_LENGTH","values","min","max","test","index","RESERVED_TEAM_NAMES","indexOf","FormattedHTMLMessage","teamSignup","JSON","parse","team","type","checkIfTeamExists","foundTeam","createTeam","err","message","currentTarget","select","nameDivClass","className","title","getSiteURL","urlTooltip","Tooltip","finishMessage","src","OverlayTrigger","trigger","delayShow","OVERLAY_TIME_DELAY","placement","overlay","ref","placeholder","maxLength","defaultValue","autoFocus","onFocus","spellCheck","Button","bsStyle","disabled","onClick","href","Component","propTypes","object","func"],"mappings":"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","file":"52.22bd7bc5d4bcf0a40072.js","sourcesContent":["webpackJsonp([52],{\n\n/***/ 2110:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _stringify = __webpack_require__(155);\n\nvar _stringify2 = _interopRequireDefault(_stringify);\n\nvar _getPrototypeOf = __webpack_require__(6);\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = __webpack_require__(4);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(5);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = __webpack_require__(7);\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = __webpack_require__(8);\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _propTypes = __webpack_require__(2);\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _react = __webpack_require__(1);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactBootstrap = __webpack_require__(40);\n\nvar _reactDom = __webpack_require__(47);\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _reactIntl = __webpack_require__(17);\n\nvar _diagnostics_actions = __webpack_require__(237);\n\nvar _team_actions = __webpack_require__(435);\n\nvar _constants = __webpack_require__(9);\n\nvar _constants2 = _interopRequireDefault(_constants);\n\nvar _url = __webpack_require__(78);\n\nvar URL = _interopRequireWildcard(_url);\n\nvar _logo = __webpack_require__(2081);\n\nvar _logo2 = _interopRequireDefault(_logo);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See License.txt for license information.\n\nvar TeamUrl = function (_React$Component) {\n    (0, _inherits3.default)(TeamUrl, _React$Component);\n\n    function TeamUrl(props) {\n        (0, _classCallCheck3.default)(this, TeamUrl);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (TeamUrl.__proto__ || (0, _getPrototypeOf2.default)(TeamUrl)).call(this, props));\n\n        _this.submitBack = _this.submitBack.bind(_this);\n        _this.submitNext = _this.submitNext.bind(_this);\n        _this.handleFocus = _this.handleFocus.bind(_this);\n\n        _this.state = {\n            nameError: '',\n            isLoading: false\n        };\n        return _this;\n    }\n\n    (0, _createClass3.default)(TeamUrl, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            (0, _diagnostics_actions.trackEvent)('signup', 'signup_team_02_url');\n        }\n    }, {\n        key: 'submitBack',\n        value: function submitBack(e) {\n            e.preventDefault();\n            this.props.state.wizard = 'display_name';\n            this.props.updateParent(this.props.state);\n        }\n    }, {\n        key: 'submitNext',\n        value: function submitNext(e) {\n            var _this2 = this;\n\n            e.preventDefault();\n\n            var name = _reactDom2.default.findDOMNode(this.refs.name).value.trim();\n            var cleanedName = URL.cleanUpUrlable(name);\n            var urlRegex = /^[a-z]+([a-z\\-0-9]+|(__)?)[a-z0-9]+$/g;\n\n            if (!name) {\n                this.setState({ nameError: _react2.default.createElement(_reactIntl.FormattedMessage, {\n                        id: 'create_team.team_url.required',\n                        defaultMessage: 'This field is required'\n                    })\n                });\n                return;\n            }\n\n            if (cleanedName.length < _constants2.default.MIN_TEAMNAME_LENGTH || cleanedName.length > _constants2.default.MAX_TEAMNAME_LENGTH) {\n                this.setState({ nameError: _react2.default.createElement(_reactIntl.FormattedMessage, {\n                        id: 'create_team.team_url.charLength',\n                        defaultMessage: 'Name must be {min} or more characters up to a maximum of {max}',\n                        values: {\n                            min: _constants2.default.MIN_TEAMNAME_LENGTH,\n                            max: _constants2.default.MAX_TEAMNAME_LENGTH\n                        }\n                    })\n                });\n                return;\n            }\n\n            if (cleanedName !== name || !urlRegex.test(name)) {\n                this.setState({ nameError: _react2.default.createElement(_reactIntl.FormattedMessage, {\n                        id: 'create_team.team_url.regex',\n                        defaultMessage: 'Use only lower case letters, numbers and dashes. Must start with a letter and can\\'t end in a dash.'\n                    })\n                });\n                return;\n            }\n\n            for (var index = 0; index < _constants2.default.RESERVED_TEAM_NAMES.length; index++) {\n                if (cleanedName.indexOf(_constants2.default.RESERVED_TEAM_NAMES[index]) === 0) {\n                    this.setState({ nameError: _react2.default.createElement(_reactIntl.FormattedHTMLMessage, {\n                            id: 'create_team.team_url.taken',\n                            defaultMessage: 'This URL <a href=\"https://docs.mattermost.com/help/getting-started/creating-teams.html#team-url\" target=\"_blank\">starts with a reserved word</a> or is unavailable. Please try another.'\n                        })\n                    });\n                    return;\n                }\n            }\n\n            this.setState({ isLoading: true });\n            var teamSignup = JSON.parse((0, _stringify2.default)(this.props.state));\n            teamSignup.team.type = 'O';\n            teamSignup.team.name = name;\n\n            (0, _team_actions.checkIfTeamExists)(name, function (foundTeam) {\n                if (foundTeam) {\n                    _this2.setState({ nameError: _react2.default.createElement(_reactIntl.FormattedMessage, {\n                            id: 'create_team.team_url.unavailable',\n                            defaultMessage: 'This URL is taken or unavailable. Please try another.'\n                        })\n                    });\n                    _this2.setState({ isLoading: false });\n                    return;\n                }\n\n                (0, _team_actions.createTeam)(teamSignup.team, function () {\n                    (0, _diagnostics_actions.trackEvent)('signup', 'signup_team_03_complete');\n                }, function (err) {\n                    _this2.setState({ nameError: err.message });\n                    _this2.setState({ isLoading: false });\n                });\n            }, function (err) {\n                _this2.setState({ nameError: err.message });\n            });\n        }\n    }, {\n        key: 'handleFocus',\n        value: function handleFocus(e) {\n            e.preventDefault();\n            e.currentTarget.select();\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var nameError = null;\n            var nameDivClass = 'form-group';\n            if (this.state.nameError) {\n                nameError = _react2.default.createElement(\n                    'label',\n                    { className: 'control-label' },\n                    this.state.nameError\n                );\n                nameDivClass += ' has-error';\n            }\n\n            var title = URL.getSiteURL() + '/';\n            var urlTooltip = _react2.default.createElement(\n                _reactBootstrap.Tooltip,\n                { id: 'urlTooltip' },\n                title\n            );\n\n            var finishMessage = _react2.default.createElement(_reactIntl.FormattedMessage, {\n                id: 'create_team.team_url.finish',\n                defaultMessage: 'Finish'\n            });\n\n            if (this.state.isLoading) {\n                finishMessage = _react2.default.createElement(_reactIntl.FormattedMessage, {\n                    id: 'create_team.team_url.creatingTeam',\n                    defaultMessage: 'Creating team...'\n                });\n            }\n\n            return _react2.default.createElement(\n                'div',\n                null,\n                _react2.default.createElement(\n                    'form',\n                    null,\n                    _react2.default.createElement('img', {\n                        className: 'signup-team-logo',\n                        src: _logo2.default\n                    }),\n                    _react2.default.createElement(\n                        'h2',\n                        null,\n                        _react2.default.createElement(_reactIntl.FormattedMessage, {\n                            id: 'create_team.team_url.teamUrl',\n                            defaultMessage: 'Team URL'\n                        })\n                    ),\n                    _react2.default.createElement(\n                        'div',\n                        { className: nameDivClass },\n                        _react2.default.createElement(\n                            'div',\n                            { className: 'row' },\n                            _react2.default.createElement(\n                                'div',\n                                { className: 'col-sm-11' },\n                                _react2.default.createElement(\n                                    'div',\n                                    { className: 'input-group input-group--limit' },\n                                    _react2.default.createElement(\n                                        _reactBootstrap.OverlayTrigger,\n                                        {\n                                            trigger: ['hover', 'focus'],\n                                            delayShow: _constants2.default.OVERLAY_TIME_DELAY,\n                                            placement: 'top',\n                                            overlay: urlTooltip\n                                        },\n                                        _react2.default.createElement(\n                                            'span',\n                                            { className: 'input-group-addon' },\n                                            title\n                                        )\n                                    ),\n                                    _react2.default.createElement('input', {\n                                        type: 'text',\n                                        ref: 'name',\n                                        className: 'form-control',\n                                        placeholder: '',\n                                        maxLength: '128',\n                                        defaultValue: this.props.state.team.name,\n                                        autoFocus: true,\n                                        onFocus: this.handleFocus,\n                                        spellCheck: 'false'\n                                    })\n                                )\n                            )\n                        ),\n                        nameError\n                    ),\n                    _react2.default.createElement(\n                        'p',\n                        null,\n                        _react2.default.createElement(_reactIntl.FormattedMessage, {\n                            id: 'create_team.team_url.webAddress',\n                            defaultMessage: 'Choose the web address of your new team:'\n                        })\n                    ),\n                    _react2.default.createElement(\n                        'ul',\n                        { className: 'color--light' },\n                        _react2.default.createElement(_reactIntl.FormattedHTMLMessage, {\n                            id: 'create_team.team_url.hint',\n                            defaultMessage: '<li>Short and memorable is best</li> <li>Use lowercase letters, numbers and dashes</li> <li>Must start with a letter and can\\'t end in a dash</li>'\n                        })\n                    ),\n                    _react2.default.createElement(\n                        'div',\n                        { className: 'margin--extra' },\n                        _react2.default.createElement(\n                            _reactBootstrap.Button,\n                            {\n                                type: 'submit',\n                                bsStyle: 'primary',\n                                disabled: this.state.isLoading,\n                                onClick: this.submitNext\n                            },\n                            finishMessage\n                        )\n                    ),\n                    _react2.default.createElement(\n                        'div',\n                        { className: 'margin--extra' },\n                        _react2.default.createElement(\n                            'a',\n                            {\n                                href: '#',\n                                onClick: this.submitBack\n                            },\n                            _react2.default.createElement(_reactIntl.FormattedMessage, {\n                                id: 'create_team.team_url.back',\n                                defaultMessage: 'Back to previous step'\n                            })\n                        )\n                    )\n                )\n            );\n        }\n    }]);\n    return TeamUrl;\n}(_react2.default.Component);\n\nexports.default = TeamUrl;\n\n\nTeamUrl.propTypes = {\n    state: _propTypes2.default.object,\n    updateParent: _propTypes2.default.func\n};\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// 52.22bd7bc5d4bcf0a40072.js","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See License.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Button, OverlayTrigger, Tooltip} from 'react-bootstrap';\nimport ReactDOM from 'react-dom';\nimport {FormattedHTMLMessage, FormattedMessage} from 'react-intl';\n\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\nimport {checkIfTeamExists, createTeam} from 'actions/team_actions.jsx';\n\nimport Constants from 'utils/constants.jsx';\nimport * as URL from 'utils/url.jsx';\n\nimport logoImage from 'images/logo.png';\n\nexport default class TeamUrl extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.submitBack = this.submitBack.bind(this);\n        this.submitNext = this.submitNext.bind(this);\n        this.handleFocus = this.handleFocus.bind(this);\n\n        this.state = {\n            nameError: '',\n            isLoading: false\n        };\n    }\n\n    componentDidMount() {\n        trackEvent('signup', 'signup_team_02_url');\n    }\n\n    submitBack(e) {\n        e.preventDefault();\n        this.props.state.wizard = 'display_name';\n        this.props.updateParent(this.props.state);\n    }\n\n    submitNext(e) {\n        e.preventDefault();\n\n        const name = ReactDOM.findDOMNode(this.refs.name).value.trim();\n        const cleanedName = URL.cleanUpUrlable(name);\n        const urlRegex = /^[a-z]+([a-z\\-0-9]+|(__)?)[a-z0-9]+$/g;\n\n        if (!name) {\n            this.setState({nameError: (\n                <FormattedMessage\n                    id='create_team.team_url.required'\n                    defaultMessage='This field is required'\n                />)\n            });\n            return;\n        }\n\n        if (cleanedName.length < Constants.MIN_TEAMNAME_LENGTH || cleanedName.length > Constants.MAX_TEAMNAME_LENGTH) {\n            this.setState({nameError: (\n                <FormattedMessage\n                    id='create_team.team_url.charLength'\n                    defaultMessage='Name must be {min} or more characters up to a maximum of {max}'\n                    values={{\n                        min: Constants.MIN_TEAMNAME_LENGTH,\n                        max: Constants.MAX_TEAMNAME_LENGTH\n                    }}\n                />)\n            });\n            return;\n        }\n\n        if (cleanedName !== name || !urlRegex.test(name)) {\n            this.setState({nameError: (\n                <FormattedMessage\n                    id='create_team.team_url.regex'\n                    defaultMessage=\"Use only lower case letters, numbers and dashes. Must start with a letter and can't end in a dash.\"\n                />)\n            });\n            return;\n        }\n\n        for (let index = 0; index < Constants.RESERVED_TEAM_NAMES.length; index++) {\n            if (cleanedName.indexOf(Constants.RESERVED_TEAM_NAMES[index]) === 0) {\n                this.setState({nameError: (\n                    <FormattedHTMLMessage\n                        id='create_team.team_url.taken'\n                        defaultMessage='This URL <a href=\"https://docs.mattermost.com/help/getting-started/creating-teams.html#team-url\" target=\"_blank\">starts with a reserved word</a> or is unavailable. Please try another.'\n                    />)\n                });\n                return;\n            }\n        }\n\n        this.setState({isLoading: true});\n        var teamSignup = JSON.parse(JSON.stringify(this.props.state));\n        teamSignup.team.type = 'O';\n        teamSignup.team.name = name;\n\n        checkIfTeamExists(name,\n            (foundTeam) => {\n                if (foundTeam) {\n                    this.setState({nameError: (\n                        <FormattedMessage\n                            id='create_team.team_url.unavailable'\n                            defaultMessage='This URL is taken or unavailable. Please try another.'\n                        />)\n                    });\n                    this.setState({isLoading: false});\n                    return;\n                }\n\n                createTeam(teamSignup.team,\n                    () => {\n                        trackEvent('signup', 'signup_team_03_complete');\n                    },\n                    (err) => {\n                        this.setState({nameError: err.message});\n                        this.setState({isLoading: false});\n                    }\n                );\n            },\n            (err) => {\n                this.setState({nameError: err.message});\n            }\n        );\n    }\n\n    handleFocus(e) {\n        e.preventDefault();\n        e.currentTarget.select();\n    }\n\n    render() {\n        let nameError = null;\n        let nameDivClass = 'form-group';\n        if (this.state.nameError) {\n            nameError = <label className='control-label'>{this.state.nameError}</label>;\n            nameDivClass += ' has-error';\n        }\n\n        const title = `${URL.getSiteURL()}/`;\n        const urlTooltip = (\n            <Tooltip id='urlTooltip'>{title}</Tooltip>\n        );\n\n        let finishMessage = (\n            <FormattedMessage\n                id='create_team.team_url.finish'\n                defaultMessage='Finish'\n            />\n        );\n\n        if (this.state.isLoading) {\n            finishMessage = (\n                <FormattedMessage\n                    id='create_team.team_url.creatingTeam'\n                    defaultMessage='Creating team...'\n                />\n            );\n        }\n\n        return (\n            <div>\n                <form>\n                    <img\n                        className='signup-team-logo'\n                        src={logoImage}\n                    />\n                    <h2>\n                        <FormattedMessage\n                            id='create_team.team_url.teamUrl'\n                            defaultMessage='Team URL'\n                        />\n                    </h2>\n                    <div className={nameDivClass}>\n                        <div className='row'>\n                            <div className='col-sm-11'>\n                                <div className='input-group input-group--limit'>\n                                    <OverlayTrigger\n                                        trigger={['hover', 'focus']}\n                                        delayShow={Constants.OVERLAY_TIME_DELAY}\n                                        placement='top'\n                                        overlay={urlTooltip}\n                                    >\n                                        <span className='input-group-addon'>\n                                            {title}\n                                        </span>\n                                    </OverlayTrigger>\n                                    <input\n                                        type='text'\n                                        ref='name'\n                                        className='form-control'\n                                        placeholder=''\n                                        maxLength='128'\n                                        defaultValue={this.props.state.team.name}\n                                        autoFocus={true}\n                                        onFocus={this.handleFocus}\n                                        spellCheck='false'\n                                    />\n                                </div>\n                            </div>\n                        </div>\n                        {nameError}\n                    </div>\n                    <p>\n                        <FormattedMessage\n                            id='create_team.team_url.webAddress'\n                            defaultMessage='Choose the web address of your new team:'\n                        />\n                    </p>\n                    <ul className='color--light'>\n                        <FormattedHTMLMessage\n                            id='create_team.team_url.hint'\n                            defaultMessage=\"<li>Short and memorable is best</li>\n                            <li>Use lowercase letters, numbers and dashes</li>\n                            <li>Must start with a letter and can't end in a dash</li>\"\n                        />\n                    </ul>\n                    <div className='margin--extra'>\n                        <Button\n                            type='submit'\n                            bsStyle='primary'\n                            disabled={this.state.isLoading}\n                            onClick={this.submitNext}\n                        >\n                            {finishMessage}\n                        </Button>\n                    </div>\n                    <div className='margin--extra'>\n                        <a\n                            href='#'\n                            onClick={this.submitBack}\n                        >\n                            <FormattedMessage\n                                id='create_team.team_url.back'\n                                defaultMessage='Back to previous step'\n                            />\n                        </a>\n                    </div>\n                </form>\n            </div>\n        );\n    }\n}\n\nTeamUrl.propTypes = {\n    state: PropTypes.object,\n    updateParent: PropTypes.func\n};\n\n\n\n// WEBPACK FOOTER //\n// ./components/create_team/components/team_url.jsx"],"sourceRoot":""}