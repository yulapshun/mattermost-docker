webpackJsonp([0],{2484:function(e,t,a){e.exports=a.p+"files/2c9d31cec343005b617e3b39fdb20895.png"},2485:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){return(0,o.default)({},t)}function s(e){return{actions:(0,d.bindActionCreators)({getChannels:u.getChannels},e)}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(19),o=n(r),i=a(31),d=a(20),u=a(65),c=a(2486),h=n(c);t.default=(0,i.connect)(l,s)(h.default)},2486:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(6),s=n(l),r=a(4),o=n(r),i=a(5),d=n(i),u=a(7),c=n(u),h=a(8),f=n(h),m=a(2),p=n(m),g=a(1),v=n(g),C=a(739),E=n(C),M=a(40),_=a(17),b=a(44),y=a(79),w=a(32),T=n(w),N=a(35),S=n(N),k=a(25),L=n(k),D=a(121),A=a(9),P=n(A),U=a(2487),O=n(U),I=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.onChange=a.onChange.bind(a),a.handleJoin=a.handleJoin.bind(a),a.handleHide=a.handleHide.bind(a),a.handleExit=a.handleExit.bind(a),a.nextPage=a.nextPage.bind(a),a.search=a.search.bind(a),a.shouldComponentUpdate=E.default.shouldComponentUpdate.bind(a),a.searchTimeoutId=0,a.state={show:!0,search:!1,channels:null,serverError:null},a}return(0,f.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){T.default.addChangeListener(this.onChange),this.props.actions.getChannels(S.default.getCurrentId(),0,100)}},{key:"componentWillUnmount",value:function(){T.default.removeChangeListener(this.onChange)}},{key:"handleHide",value:function(){this.setState({show:!1})}},{key:"handleExit",value:function(){this.props.onModalDismissed&&this.props.onModalDismissed()}},{key:"onChange",value:function(e){this.state.search&&!e||this.setState({channels:T.default.getMoreChannelsList(),serverError:null})}},{key:"nextPage",value:function(e){this.props.actions.getChannels(S.default.getCurrentId(),e+1,50)}},{key:"handleJoin",value:function(e,t){var a=this;(0,y.joinChannel)(e,function(){b.browserHistory.push(S.default.getCurrentTeamRelativeUrl()+"/channels/"+e.name),t&&t(),a.handleHide()},function(e){a.setState({serverError:e.message}),t&&t()})}},{key:"search",value:function(e){var t=this;if(clearTimeout(this.searchTimeoutId),""===e)return this.onChange(!0),this.setState({search:!1}),void(this.searchTimeoutId="");var a=setTimeout(function(){(0,y.searchMoreChannels)(e,function(e){a===t.searchTimeoutId&&t.setState({search:!0,channels:e})})},100);this.searchTimeoutId=a}},{key:"render",value:function(){var e=void 0;this.state.serverError&&(e=v.default.createElement("div",{className:"form-group has-error"},v.default.createElement("label",{className:"control-label"},this.state.serverError)));var t=v.default.createElement("button",{id:"createNewChannel",type:"button",className:"btn btn-primary channel-create-btn",onClick:this.props.handleNewChannel},v.default.createElement(_.FormattedMessage,{id:"more_channels.create",defaultMessage:"Create New Channel"})),a=v.default.createElement("p",{className:"secondary-message"},v.default.createElement(_.FormattedMessage,{id:"more_channels.createClick",defaultMessage:"Click 'Create New Channel' to make a new one"})),n=S.default.isTeamAdminForCurrentTeam(),l=L.default.isSystemAdminForCurrentUser();return(0,D.showCreateOption)(P.default.OPEN_CHANNEL,n,l)||(t=null,a=null),v.default.createElement(M.Modal,{dialogClassName:"more-modal more-modal--action",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit},v.default.createElement(M.Modal.Header,{closeButton:!0},v.default.createElement(M.Modal.Title,null,v.default.createElement(_.FormattedMessage,{id:"more_channels.title",defaultMessage:"More Channels"})),t),v.default.createElement(M.Modal.Body,null,v.default.createElement(O.default,{channels:this.state.channels,channelsPerPage:50,nextPage:this.nextPage,isSearch:this.state.search,search:this.search,handleJoin:this.handleJoin,noResultsText:a}),e))}}]),t}(v.default.Component);I.propTypes={onModalDismissed:p.default.func,handleNewChannel:p.default.func,actions:p.default.shape({getChannels:p.default.func.isRequired}).isRequired},t.default=I},2487:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(6),s=n(l),r=a(4),o=n(r),i=a(5),d=n(i),u=a(7),c=n(u),h=a(8),f=n(h),m=a(0),p=n(m),g=a(2),v=n(g),C=a(1),E=n(C),M=a(47),_=n(M),b=a(17),y=a(87),w=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(y),T=a(16),N=a(208),S=n(N),k=a(236),L=n(k),D=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.createChannelRow=a.createChannelRow.bind(a),a.nextPage=a.nextPage.bind(a),a.previousPage=a.previousPage.bind(a),a.doSearch=a.doSearch.bind(a),a.nextTimeoutId=0,a.state={joiningChannel:"",page:0,nextDisabled:!1},a}return(0,f.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){w.isMobile()||this.refs.filter.focus()}},{key:"componentDidUpdate",value:function(e,t){t.page!==this.state.page&&(0,p.default)(this.refs.channelList).scrollTop(0)}},{key:"componentWillReceiveProps",value:function(e){e.isSearch&&!this.props.isSearch&&this.setState({page:0})}},{key:"handleJoin",value:function(e){var t=this;this.setState({joiningChannel:e.id}),this.props.handleJoin(e,function(){t.setState({joiningChannel:""})})}},{key:"createChannelRow",value:function(e){var t=void 0;return t=this.state.joiningChannel===e.id?E.default.createElement("img",{className:"join-channel-loading-gif",src:S.default}):E.default.createElement("button",{onClick:this.handleJoin.bind(this,e),className:"btn btn-primary",disabled:""!==this.state.joiningChannel&&this.state.joiningChannel!==e.id},E.default.createElement(b.FormattedMessage,{id:"more_channels.join",defaultMessage:"Join"})),E.default.createElement("div",{className:"more-modal__row",key:e.id},E.default.createElement("div",{className:"more-modal__details"},E.default.createElement("p",{className:"more-modal__name"},e.display_name),E.default.createElement("p",{className:"more-modal__description"},e.purpose)),E.default.createElement("div",{className:"more-modal__actions"},t))}},{key:"nextPage",value:function(e){var t=this;e.preventDefault(),this.setState({page:this.state.page+1,nextDisabled:!0}),this.nextTimeoutId=setTimeout(function(){return t.setState({nextDisabled:!1})},500),this.props.nextPage(this.state.page+1),(0,p.default)(_.default.findDOMNode(this.refs.channelListScroll)).scrollTop(0)}},{key:"previousPage",value:function(e){e.preventDefault(),this.setState({page:this.state.page-1}),(0,p.default)(_.default.findDOMNode(this.refs.channelListScroll)).scrollTop(0)}},{key:"doSearch",value:function(){var e=this.refs.filter.value;this.props.search(e),""===e&&this.setState({page:0})}},{key:"render",value:function(){var e=this.props.channels,t=void 0,a=void 0,n=void 0;if(null==e)t=E.default.createElement(L.default,null);else if(0===e.length)t=E.default.createElement("div",{className:"no-channel-message"},E.default.createElement("p",{className:"primary-message"},E.default.createElement(b.FormattedMessage,{id:"more_channels.noMore",defaultMessage:"No more channels to join"})),this.props.noResultsText);else{var l=this.state.page*this.props.channelsPerPage,s=l+this.props.channelsPerPage,r=this.props.channels.slice(l,s);t=r.map(this.createChannelRow),r.length>=this.props.channelsPerPage&&s<this.props.channels.length&&(a=E.default.createElement("button",{className:"btn btn-default filter-control filter-control__next",onClick:this.nextPage,disabled:this.state.nextDisabled},E.default.createElement(b.FormattedMessage,{id:"more_channels.next",defaultMessage:"Next"}))),this.state.page>0&&(n=E.default.createElement("button",{className:"btn btn-default filter-control filter-control__prev",onClick:this.previousPage},E.default.createElement(b.FormattedMessage,{id:"more_channels.prev",defaultMessage:"Previous"})))}return E.default.createElement("div",{className:"filtered-user-list"},E.default.createElement("div",{className:"filter-row"},E.default.createElement("div",{className:"col-sm-12"},E.default.createElement("input",{id:"searchChannelsTextbox",ref:"filter",className:"form-control filter-textbox",placeholder:(0,T.localizeMessage)("filtered_channels_list.search","Search channels"),onInput:this.doSearch}))),E.default.createElement("div",{ref:"channelList",className:"more-modal__list"},E.default.createElement("div",{ref:"channelListScroll"},t)),E.default.createElement("div",{className:"filter-controls"},n,a))}}]),t}(E.default.Component);t.default=D,D.defaultProps={channels:[],isSearch:!1},D.propTypes={channels:v.default.arrayOf(v.default.object),channelsPerPage:v.default.number,nextPage:v.default.func.isRequired,isSearch:v.default.bool,search:v.default.func.isRequired,handleJoin:v.default.func.isRequired,noResultsText:v.default.object}},2488:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){return(0,o.default)({},t)}function s(e){return{actions:(0,d.bindActionCreators)({getProfiles:u.getProfiles,getProfilesInTeam:u.getProfilesInTeam},e)}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(19),o=n(r),i=a(31),d=a(20),u=a(61),c=a(2489),h=n(c);t.default=(0,i.connect)(l,s)(h.default)},2489:function(e,t,a){"use strict";(function(e){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(41),s=n(l),r=a(6),o=n(r),i=a(4),d=n(i),u=a(5),c=n(u),h=a(7),f=n(h),m=a(8),p=n(m),g=a(2),v=n(g),C=a(1),E=n(C),M=a(40),_=a(17),b=a(44),y=a(29),w=a(50),T=a(79),N=a(69),S=a(38),k=n(S),L=a(35),D=n(L),A=a(25),P=n(A),U=a(9),O=n(U),I=a(16),R=a(450),F=n(R),x=a(181),H=n(x),j=O.default.MAX_USERS_IN_GM-1,q=function(t){function a(t){(0,d.default)(this,a);var n=(0,f.default)(this,(a.__proto__||(0,o.default)(a)).call(this,t));n.resetPaging=function(){n.refs.multiselect&&n.refs.multiselect.resetPaging()},n.handleHide=n.handleHide.bind(n),n.handleExit=n.handleExit.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n.handleDelete=n.handleDelete.bind(n),n.handlePageChange=n.handlePageChange.bind(n),n.onChange=n.onChange.bind(n),n.search=n.search.bind(n),n.addValue=n.addValue.bind(n),n.searchTimeoutId=0,n.term="",n.listType=e.window.mm_config.RestrictDirectMessage;var l=[];if(t.startingUsers)for(var r=0;r<t.startingUsers.length;r++){var i=(0,s.default)({},t.startingUsers[r]);i.value=i.id,i.label="@"+i.username,l.push(i)}return n.state={users:null,values:l,show:!0,search:!1,loadingChannel:-1},n}return(0,p.default)(a,t),(0,c.default)(a,[{key:"componentDidMount",value:function(){P.default.addChangeListener(this.onChange),P.default.addInTeamChangeListener(this.onChange),P.default.addStatusesChangeListener(this.onChange),"any"===this.listType?this.props.actions.getProfiles(0,100):this.props.actions.getProfilesInTeam(D.default.getCurrentId(),0,100)}},{key:"componentWillUnmount",value:function(){P.default.removeChangeListener(this.onChange),P.default.removeInTeamChangeListener(this.onChange),P.default.removeStatusesChangeListener(this.onChange)}},{key:"handleHide",value:function(){this.setState({show:!1})}},{key:"handleExit",value:function(){this.exitToChannel&&b.browserHistory.push(this.exitToChannel),this.props.onModalDismissed&&this.props.onModalDismissed()}},{key:"handleSubmit",value:function(e){var t=this;if(e&&e.preventDefault(),-1===this.state.loadingChannel){var a=this.state.values.map(function(e){return e.id});if(0!==a.length){this.setState({loadingChannel:1});var n=function(e){t.exitToChannel=D.default.getCurrentTeamRelativeUrl()+"/channels/"+e.name,t.setState({loadingChannel:-1}),t.handleHide()},l=function(){t.setState({loadingChannel:-1})};1===a.length?(0,T.openDirectChannelToUser)(a[0],n,l):(0,T.openGroupChannelToUsers)(a,n,l)}}}},{key:"addValue",value:function(e){var t=(0,s.default)([],this.state.values);-1===t.indexOf(e)&&t.push(e),this.setState({values:t})}},{key:"onChange",value:function(){var e=void 0;e=this.term?"any"===this.listType?(0,s.default)([],(0,w.searchProfiles)(k.default.getState(),this.term,!0)):(0,s.default)([],(0,w.searchProfilesInCurrentTeam)(k.default.getState(),this.term,!0)):"any"===this.listType?(0,s.default)([],P.default.getProfileList(!0)):(0,s.default)([],P.default.getProfileListInTeam(D.default.getCurrentId(),!0));for(var t=0;t<e.length;t++){var a=(0,s.default)({},e[t]);a.value=a.id,a.label="@"+a.username,e[t]=a}this.setState({users:e})}},{key:"handlePageChange",value:function(e,t){e>t&&("any"===this.listType?this.props.actions.getProfiles(e+1,50):this.props.actions.getProfilesInTeam(e+1,50))}},{key:"search",value:function(e){var t=this;if(clearTimeout(this.searchTimeoutId),this.term=e,""===e)return this.resetPaging(),void this.onChange();var a=void 0;a="any"===this.listType?"":D.default.getCurrentId(),this.searchTimeoutId=setTimeout(function(){(0,N.searchUsers)(e,a,{},t.resetPaging)},O.default.SEARCH_TIMEOUT_MILLISECONDS)}},{key:"handleDelete",value:function(e){this.setState({values:e})}},{key:"renderOption",value:function(e,t,a){var n="";return t&&(n="more-modal__row--selected"),E.default.createElement("div",{key:e.id,ref:t?"selected":e.id,className:"more-modal__row clickable "+n,onClick:function(){return a(e)}},E.default.createElement(H.default,{src:y.Client4.getProfilePictureUrl(e.id,e.last_picture_update),status:""+P.default.getStatus(e.id),width:"32",height:"32"}),E.default.createElement("div",{className:"more-modal__details"},E.default.createElement("div",{className:"more-modal__name"},(0,I.displayEntireNameForUser)(e)),E.default.createElement("div",{className:"more-modal__description"},e.email)),E.default.createElement("div",{className:"more-modal__actions"},E.default.createElement("div",{className:"more-modal__actions--round"},E.default.createElement("i",{className:"fa fa-plus"}))))}},{key:"renderValue",value:function(e){return e.username}},{key:"render",value:function(){var e=void 0;this.props.startingUsers&&(e=this.state.values&&this.state.values.length>=j?E.default.createElement(_.FormattedMessage,{id:"more_direct_channels.new_convo_note.full",defaultMessage:"You’ve reached the maximum number of people for this conversation. Consider creating a private channel instead."}):E.default.createElement(_.FormattedMessage,{id:"more_direct_channels.new_convo_note",defaultMessage:"This will start a new conversation. If you’re adding a lot of people, consider creating a private channel instead."}));var t=E.default.createElement(_.FormattedMessage,{id:"multiselect.go",defaultMessage:"Go"}),a=E.default.createElement(_.FormattedMessage,{id:"multiselect.numPeopleRemaining",defaultMessage:"Use ↑↓ to browse, ↵ to select. You can add {num, number} more {num, plural, one {person} other {people}}. ",values:{num:j-this.state.values.length}}),n=[];return this.state.users&&(n=this.state.users.filter(function(e){return 0===e.delete_at})),E.default.createElement(M.Modal,{dialogClassName:"more-modal more-direct-channels",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit},E.default.createElement(M.Modal.Header,{closeButton:!0},E.default.createElement(M.Modal.Title,null,E.default.createElement(_.FormattedMessage,{id:"more_direct_channels.title",defaultMessage:"Direct Messages"}))),E.default.createElement(M.Modal.Body,null,E.default.createElement(F.default,{key:"moreDirectChannelsList",ref:"multiselect",options:n,optionRenderer:this.renderOption,values:this.state.values,valueRenderer:this.renderValue,perPage:50,handlePageChange:this.handlePageChange,handleInput:this.search,handleDelete:this.handleDelete,handleAdd:this.addValue,handleSubmit:this.handleSubmit,noteText:e,maxValues:j,numRemainingText:a,buttonSubmitText:t})))}}]),a}(E.default.Component);q.propTypes={startingUsers:v.default.arrayOf(v.default.object),onModalDismissed:v.default.func,actions:v.default.shape({getProfiles:v.default.func.isRequired,getProfilesInTeam:v.default.func.isRequired}).isRequired},t.default=q}).call(t,a(22))},2490:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(6),s=n(l),r=a(4),o=n(r),i=a(5),d=n(i),u=a(7),c=n(u),h=a(8),f=n(h),m=a(2),p=n(m),g=a(1),v=n(g),C=a(17),E=a(44),M=a(79),_=a(35),b=n(_),y=a(78),w=a(16),T=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(w),N=a(2491),S=n(N),k=a(2493),L=n(k),D=1,A=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.doSubmit=a.doSubmit.bind(a),a.onModalExited=a.onModalExited.bind(a),a.typeSwitched=a.typeSwitched.bind(a),a.urlChangeRequested=a.urlChangeRequested.bind(a),a.urlChangeSubmitted=a.urlChangeSubmitted.bind(a),a.urlChangeDismissed=a.urlChangeDismissed.bind(a),a.channelDataChanged=a.channelDataChanged.bind(a),a.state={serverError:"",channelType:"O",flowState:D,channelDisplayName:"",channelName:"",channelPurpose:"",channelHeader:"",nameModified:!1},a}return(0,f.default)(t,e),(0,d.default)(t,[{key:"componentWillReceiveProps",value:function(e){!0===e.show&&!1===this.props.show&&this.setState({serverError:"",channelType:e.channelType,flowState:D,channelDisplayName:"",channelName:"",channelPurpose:"",channelHeader:"",nameModified:!1})}},{key:"doSubmit",value:function(){var e=this;if(!this.state.channelDisplayName)return void this.setState({serverError:T.localizeMessage("channel_flow.invalidName","Invalid Channel Name")});if(this.state.channelName<2)return void this.setState({flowState:3});var t={team_id:b.default.getCurrentId(),name:this.state.channelName,display_name:this.state.channelDisplayName,purpose:this.state.channelPurpose,header:this.state.channelHeader,type:this.state.channelType};(0,M.createChannel)(t,function(t){e.doOnModalExited=function(){E.browserHistory.push(b.default.getCurrentTeamRelativeUrl()+"/channels/"+t.name)},e.props.onModalDismissed()},function(t){return"model.channel.is_valid.2_or_more.app_error"===t.id?void e.setState({flowState:3,serverError:v.default.createElement(C.FormattedMessage,{id:"channel_flow.handleTooShort",defaultMessage:"Channel URL must be 2 or more lowercase alphanumeric characters"})}):"store.sql_channel.update.exists.app_error"===t.id?void e.setState({serverError:T.localizeMessage("channel_flow.alreadyExist","A channel with that URL already exists")}):void e.setState({serverError:t.message})})}},{key:"onModalExited",value:function(){this.doOnModalExited&&this.doOnModalExited()}},{key:"typeSwitched",value:function(){"P"===this.state.channelType?this.setState({channelType:"O"}):this.setState({channelType:"P"})}},{key:"urlChangeRequested",value:function(){this.setState({flowState:2})}},{key:"urlChangeSubmitted",value:function(e){3===this.state.flowState?this.setState({channelName:e,nameModified:!0},this.doSubmit):this.setState({flowState:D,serverError:null,channelName:e,nameModified:!0})}},{key:"urlChangeDismissed",value:function(){this.setState({flowState:D})}},{key:"channelDataChanged",value:function(e){this.setState({channelDisplayName:e.displayName,channelPurpose:e.purpose,channelHeader:e.header}),this.state.nameModified||this.setState({channelName:(0,y.cleanUpUrlable)(e.displayName.trim())})}},{key:"render",value:function(){var e={name:this.state.channelName,displayName:this.state.channelDisplayName,purpose:this.state.channelPurpose},t=!1,a=!1,n=!1,l="",s="";if(this.props.show)switch(this.state.flowState){case D:"O"===this.state.channelType?t=!0:a=!0;break;case 2:n=!0,l=v.default.createElement(C.FormattedMessage,{id:"channel_flow.changeUrlTitle",defaultMessage:"Change Channel URL"}),s=l;break;case 3:n=!0,l=v.default.createElement(C.FormattedMessage,{id:"channel_flow.set_url_title",defaultMessage:"Set Channel URL"}),s=v.default.createElement(C.FormattedMessage,{id:"channel_flow.create",defaultMessage:"Create Channel"})}return v.default.createElement("span",null,v.default.createElement(S.default,{show:t,channelType:"O",channelData:e,serverError:this.state.serverError,onSubmitChannel:this.doSubmit,onModalDismissed:this.props.onModalDismissed,onModalExited:this.onModalExited,onTypeSwitched:this.typeSwitched,onChangeURLPressed:this.urlChangeRequested,onDataChanged:this.channelDataChanged}),v.default.createElement(S.default,{show:a,channelType:"P",channelData:e,serverError:this.state.serverError,onSubmitChannel:this.doSubmit,onModalExited:this.onModalExited,onModalDismissed:this.props.onModalDismissed,onTypeSwitched:this.typeSwitched,onChangeURLPressed:this.urlChangeRequested,onDataChanged:this.channelDataChanged}),v.default.createElement(L.default,{show:n,title:l,submitButtonText:s,currentURL:this.state.channelName,serverError:this.state.serverError,onModalSubmit:this.urlChangeSubmitted,onModalDismissed:this.urlChangeDismissed,onModalExited:this.onModalExited}))}}]),t}(v.default.Component);t.default=A,A.defaultProps={show:!1,channelType:"O"},A.propTypes={show:p.default.bool.isRequired,channelType:p.default.string.isRequired,onModalDismissed:p.default.func.isRequired}},2491:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){return(0,r.default)({},t,{ctrlSend:(0,d.getBool)(e,i.Preferences.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter"),isTeamAdmin:(0,u.isCurrentUserCurrentTeamAdmin)(e),isSystemAdmin:(0,c.isCurrentUserSystemAdmin)(e)})}Object.defineProperty(t,"__esModule",{value:!0});var s=a(19),r=n(s),o=a(31),i=a(26),d=a(64),u=a(120),c=a(50),h=a(2492),f=n(h);t.default=(0,o.connect)(l)(f.default)},2492:function(e,t,a){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=a(6),r=l(s),o=a(4),i=l(o),d=a(5),u=l(d),c=a(7),h=l(c),f=a(8),m=l(f),p=a(0),g=l(p),v=a(2),C=l(v),E=a(1),M=l(E),_=a(40),b=a(47),y=l(b),w=a(17),T=a(121),N=n(T),S=a(9),k=l(S),L=a(78),D=a(87),A=n(D),P=a(16),U=n(P),O=function(e){function t(e){(0,i.default)(this,t);var a=(0,h.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.handleSubmit=a.handleSubmit.bind(a),a.handleChange=a.handleChange.bind(a),a.onEnterKeyDown=a.onEnterKeyDown.bind(a),a.state={displayNameError:""},a}return(0,m.default)(t,e),(0,u.default)(t,[{key:"componentWillReceiveProps",value:function(e){!0===e.show&&!1===this.props.show?(this.setState({displayNameError:""}),document.addEventListener("keydown",this.onEnterKeyDown)):!1===e.show&&!0===this.props.show&&document.removeEventListener("keydown",this.onEnterKeyDown)}},{key:"componentDidMount",value:function(){(A.isInternetExplorer()||A.isEdge())&&(0,g.default)("body").addClass("browser--ie")}},{key:"onEnterKeyDown",value:function(e){this.props.ctrlSend&&e.keyCode===k.default.KeyCodes.ENTER&&e.ctrlKey?this.handleSubmit(e):this.props.ctrlSend||e.keyCode!==k.default.KeyCodes.ENTER||e.shiftKey||e.altKey||this.handleSubmit(e)}},{key:"handleSubmit",value:function(e){if(e.preventDefault(),y.default.findDOMNode(this.refs.display_name).value.trim().length<k.default.MIN_CHANNELNAME_LENGTH)return void this.setState({displayNameError:!0});this.props.onSubmitChannel()}},{key:"handleChange",value:function(){var e={displayName:this.refs.display_name.value,header:this.refs.channel_header.value,purpose:this.refs.channel_purpose.value};this.props.onDataChanged(e)}},{key:"render",value:function(){var e=null,t=null,a="form-group";this.state.displayNameError&&(e=M.default.createElement("p",{className:"input__help error"},M.default.createElement(w.FormattedMessage,{id:"channel_modal.displayNameError",defaultMessage:"Channel name must be 2 or more characters"}),this.state.displayNameError),a+=" has-error"),this.props.serverError&&(t=M.default.createElement("div",{className:"form-group has-error"},M.default.createElement("div",{className:"col-sm-12"},M.default.createElement("p",{className:"input__help error"},this.props.serverError))));var n=M.default.createElement("a",{href:"#",onClick:this.props.onTypeSwitched},M.default.createElement(w.FormattedMessage,{id:"channel_modal.publicChannel1",defaultMessage:"Create a public channel"})),l=M.default.createElement("a",{href:"#",onClick:this.props.onTypeSwitched},M.default.createElement(w.FormattedMessage,{id:"channel_modal.privateGroup2",defaultMessage:"Create a private channel"}));N.showCreateOption(k.default.OPEN_CHANNEL,this.props.isTeamAdmin,this.props.isSystemAdmin)||(n=null),N.showCreateOption(k.default.PRIVATE_CHANNEL,this.props.isTeamAdmin,this.props.isSystemAdmin)||(l=null);var s="",r="";switch(this.props.channelType){case"P":s=M.default.createElement("div",{className:"modal-intro"},M.default.createElement(w.FormattedMessage,{id:"channel_modal.privateGroup1",defaultMessage:"Create a new private channel with restricted membership. "}),n),r="newPrivateChannel";break;case"O":s=M.default.createElement("div",{className:"modal-intro"},M.default.createElement(w.FormattedMessage,{id:"channel_modal.publicChannel2",defaultMessage:"Create a new public channel anyone can join. "}),l),r="newPublicChannel"}var o=(0,L.getShortenedURL)();return M.default.createElement("span",null,M.default.createElement(_.Modal,{dialogClassName:"new-channel__modal",show:this.props.show,bsSize:"large",onHide:this.props.onModalDismissed,onExited:this.props.onModalExited},M.default.createElement(_.Modal.Header,{closeButton:!0},M.default.createElement(_.Modal.Title,null,M.default.createElement(w.FormattedMessage,{id:"channel_modal.modalTitle",defaultMessage:"New Channel"}))),M.default.createElement("form",{role:"form",className:"form-horizontal"},M.default.createElement(_.Modal.Body,null,M.default.createElement("div",null,s),M.default.createElement("div",{className:a},M.default.createElement("label",{className:"col-sm-3 form__label control-label"},M.default.createElement(w.FormattedMessage,{id:"channel_modal.name",defaultMessage:"Name"})),M.default.createElement("div",{className:"col-sm-9"},M.default.createElement("input",{id:r+"Name",onChange:this.handleChange,type:"text",ref:"display_name",className:"form-control",placeholder:U.localizeMessage("channel_modal.nameEx",'E.g.: "Bugs", "Marketing", "客户支持"'),maxLength:k.default.MAX_CHANNELNAME_LENGTH,value:this.props.channelData.displayName,autoFocus:!0,tabIndex:"1"}),e,M.default.createElement("p",{className:"input__help dark"},"URL: "+o+this.props.channelData.name+" (",M.default.createElement("button",{className:"color--link style--none",onClick:this.props.onChangeURLPressed},M.default.createElement(w.FormattedMessage,{id:"channel_modal.edit",defaultMessage:"Edit"})),")"))),M.default.createElement("div",{className:"form-group"},M.default.createElement("div",{className:"col-sm-3"},M.default.createElement("label",{className:"form__label control-label"},M.default.createElement(w.FormattedMessage,{id:"channel_modal.purpose",defaultMessage:"Purpose"})),M.default.createElement("label",{className:"form__label light"},M.default.createElement(w.FormattedMessage,{id:"channel_modal.optional",defaultMessage:"(optional)"}))),M.default.createElement("div",{className:"col-sm-9"},M.default.createElement("textarea",{id:r+"Purpose",className:"form-control no-resize",ref:"channel_purpose",rows:"4",placeholder:U.localizeMessage("channel_modal.purposeEx",'E.g.: "A channel to file bugs and improvements"'),maxLength:"250",value:this.props.channelData.purpose,onChange:this.handleChange,tabIndex:"2"}),M.default.createElement("p",{className:"input__help"},M.default.createElement(w.FormattedMessage,{id:"channel_modal.descriptionHelp",defaultMessage:"Describe how this channel should be used."})))),M.default.createElement("div",{className:"form-group less"},M.default.createElement("div",{className:"col-sm-3"},M.default.createElement("label",{className:"form__label control-label"},M.default.createElement(w.FormattedMessage,{id:"channel_modal.header",defaultMessage:"Header"})),M.default.createElement("label",{className:"form__label light"},M.default.createElement(w.FormattedMessage,{id:"channel_modal.optional",defaultMessage:"(optional)"}))),M.default.createElement("div",{className:"col-sm-9"},M.default.createElement("textarea",{id:r+"Header",className:"form-control no-resize",ref:"channel_header",rows:"4",placeholder:U.localizeMessage("channel_modal.headerEx",'E.g.: "[Link Title](http://example.com)"'),maxLength:"1024",value:this.props.channelData.header,onChange:this.handleChange,tabIndex:"2"}),M.default.createElement("p",{className:"input__help"},M.default.createElement(w.FormattedMessage,{id:"channel_modal.headerHelp",defaultMessage:"Set text that will appear in the header of the channel beside the channel name. For example, include frequently used links by typing [Link Title](http://example.com)."})),t))),M.default.createElement(_.Modal.Footer,null,M.default.createElement("button",{type:"button",className:"btn btn-default",onClick:this.props.onModalDismissed},M.default.createElement(w.FormattedMessage,{id:"channel_modal.cancel",defaultMessage:"Cancel"})),M.default.createElement("button",{onClick:this.handleSubmit,type:"submit",className:"btn btn-primary",tabIndex:"3"},M.default.createElement(w.FormattedMessage,{id:"channel_modal.createNew",defaultMessage:"Create New Channel"}))))))}}]),t}(M.default.PureComponent);O.propTypes={show:C.default.bool.isRequired,channelType:C.default.string.isRequired,channelData:C.default.object.isRequired,ctrlSend:C.default.bool,isTeamAdmin:C.default.bool,isSystemAdmin:C.default.bool,serverError:C.default.node,onSubmitChannel:C.default.func.isRequired,onModalDismissed:C.default.func.isRequired,onModalExited:C.default.func,onTypeSwitched:C.default.func.isRequired,onChangeURLPressed:C.default.func.isRequired,onDataChanged:C.default.func.isRequired},t.default=O},2493:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(6),s=n(l),r=a(4),o=n(r),i=a(5),d=n(i),u=a(7),c=n(u),h=a(8),f=n(h),m=a(2),p=n(m),g=a(1),v=n(g),C=a(40),E=a(47),M=n(E),_=a(17),b=a(35),y=n(b),w=a(9),T=n(w),N=a(78),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(N),k=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.onURLChanged=a.onURLChanged.bind(a),a.doSubmit=a.doSubmit.bind(a),a.doCancel=a.doCancel.bind(a),a.state={currentURL:e.currentURL,urlError:"",userEdit:!1},a}return(0,f.default)(t,e),(0,d.default)(t,[{key:"componentWillReceiveProps",value:function(e){this.state.userEdit||this.setState({currentURL:e.currentURL})}},{key:"componentDidUpdate",value:function(e){!0===this.props.show&&!1===e.show&&M.default.findDOMNode(this.refs.urlinput).select()}},{key:"onURLChanged",value:function(e){var t=e.target.value.trim();this.setState({currentURL:t.replace(/[^A-Za-z0-9-_]/g,"").toLowerCase(),userEdit:!0})}},{key:"getURLError",value:function(e){var t=[];return e.length<2&&t.push(v.default.createElement("span",{key:"error1"},v.default.createElement(_.FormattedMessage,{id:"change_url.longer",defaultMessage:"URL must be two or more characters."}),v.default.createElement("br",null))),"-"!==e.charAt(0)&&"_"!==e.charAt(0)||t.push(v.default.createElement("span",{key:"error2"},v.default.createElement(_.FormattedMessage,{id:"change_url.startWithLetter",defaultMessage:"URL must start with a letter or number."}),v.default.createElement("br",null))),e.length>1&&("-"===e.charAt(e.length-1)||"_"===e.charAt(e.length-1))&&t.push(v.default.createElement("span",{key:"error3"},v.default.createElement(_.FormattedMessage,{id:"change_url.endWithLetter",defaultMessage:"URL must end with a letter or number."}),v.default.createElement("br",null))),e.indexOf("__")>-1&&t.push(v.default.createElement("span",{key:"error4"},v.default.createElement(_.FormattedMessage,{id:"change_url.noUnderscore",defaultMessage:"URL can not contain two underscores in a row."}),v.default.createElement("br",null))),0===t.length&&t.push(v.default.createElement("span",{key:"errorlast"},v.default.createElement(_.FormattedMessage,{id:"change_url.invalidUrl",defaultMessage:"Invalid URL"}),v.default.createElement("br",null))),t}},{key:"doSubmit",value:function(e){e.preventDefault();var t=M.default.findDOMNode(this.refs.urlinput).value;if(S.cleanUpUrlable(t)!==t||t.length<2||t.indexOf("__")>-1)return void this.setState({urlError:this.getURLError(t)});this.setState({urlError:"",userEdit:!1}),this.props.onModalSubmit(t)}},{key:"doCancel",value:function(){this.setState({urlError:"",userEdit:!1}),this.props.onModalDismissed()}},{key:"render",value:function(){var e="input-group input-group--limit",t=null;this.state.urlError&&(e+=" has-error"),(this.props.serverError||this.state.urlError)&&(t=v.default.createElement("div",{className:"form-group has-error"},v.default.createElement("p",{className:"input__help error"},this.state.urlError||this.props.serverError)));var a=y.default.getCurrentTeamUrl()+"/channels",n=S.getShortenedURL(a),l=v.default.createElement(C.Tooltip,{id:"urlTooltip"},a);return v.default.createElement(C.Modal,{show:this.props.show,onHide:this.doCancel,onExited:this.props.onModalExited},v.default.createElement(C.Modal.Header,{closeButton:!0},v.default.createElement(C.Modal.Title,null,this.props.title)),v.default.createElement("form",{role:"form",className:"form-horizontal"},v.default.createElement(C.Modal.Body,null,v.default.createElement("div",{className:"modal-intro"},v.default.createElement(_.FormattedMessage,{id:"channel_flow.changeUrlDescription",defaultMessage:"Some characters are now allowed in URLs and may be removed."})),v.default.createElement("div",{className:"form-group"},v.default.createElement("label",{className:"col-sm-2 form__label control-label"},v.default.createElement(_.FormattedMessage,{id:"change_url.urlLabel",defaultMessage:"Channel URL"})),v.default.createElement("div",{className:"col-sm-10"},v.default.createElement("div",{className:e},v.default.createElement(C.OverlayTrigger,{trigger:["hover","focus"],delayShow:T.default.OVERLAY_TIME_DELAY,placement:"top",overlay:l},v.default.createElement("span",{className:"input-group-addon"},n)),v.default.createElement("input",{type:"text",ref:"urlinput",className:"form-control",maxLength:T.default.MAX_CHANNELNAME_LENGTH,onChange:this.onURLChanged,value:this.state.currentURL,autoFocus:!0,tabIndex:"1"})),t))),v.default.createElement(C.Modal.Footer,null,v.default.createElement("button",{type:"button",className:"btn btn-default",onClick:this.doCancel},v.default.createElement(_.FormattedMessage,{id:"change_url.close",defaultMessage:"Close"})),v.default.createElement("button",{onClick:this.doSubmit,type:"submit",className:"btn btn-primary",tabIndex:"2"},this.props.submitButtonText))))}}]),t}(v.default.Component);t.default=k,k.defaultProps={show:!1,title:"Change URL",submitButtonText:"Save",currentURL:"",serverError:null},k.propTypes={show:p.default.bool.isRequired,title:p.default.node,submitButtonText:p.default.node,currentURL:p.default.string,serverError:p.default.node,onModalSubmit:p.default.func.isRequired,onModalExited:p.default.func,onModalDismissed:p.default.func.isRequired}},2494:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(19),s=n(l),r=a(6),o=n(r),i=a(4),d=n(i),u=a(5),c=n(u),h=a(7),f=n(h),m=a(8),p=n(m),g=a(2),v=n(g),C=a(1),E=n(C),M=a(40),_=a(119),b=n(_),y=a(9),w=a(16),T=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(w),N=a(2495),S=n(N),k=a(742),L=a(2498),D=n(L),A=function(e){function t(e){(0,d.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return a.handleResize=function(){var e=T.isMobile();a.setState({isMobile:e})},a.getPreferences=function(){return a.props.currentUser?{showTutorialTip:b.default.getInt(y.Preferences.TUTORIAL_STEP,a.props.currentUser.id,999)===y.TutorialSteps.MENU_POPOVER&&!T.isMobile()}:{}},a.getStateFromStores=function(){var e=a.getPreferences(),t=T.isMobile();return(0,s.default)({},e,{isMobile:t})},a.onPreferenceChange=function(){a.setState(a.getPreferences())},a.toggleDropdown=function(e){e.preventDefault(),a.refs.dropdown.toggleDropdown()},a.renderStatusDropdown=function(){return a.state.isMobile?null:E.default.createElement(S.default,null)},a.state=a.getStateFromStores(),a}return(0,p.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){b.default.addChangeListener(this.onPreferenceChange),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){b.default.removeChangeListener(this.onPreferenceChange),window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){var e=this.renderStatusDropdown(),t=null;this.state.showTutorialTip&&(t=(0,k.createMenuTip)(this.toggleDropdown));var a=null;return a=""===this.props.teamDescription?E.default.createElement("div",{id:"headerTeamName",className:"team__name"},this.props.teamDisplayName):E.default.createElement(M.OverlayTrigger,{trigger:["hover","focus"],delayShow:y.Constants.OVERLAY_TIME_DELAY,placement:"bottom",overlay:E.default.createElement(M.Tooltip,{id:"team-name__tooltip"},this.props.teamDescription),ref:"descriptionOverlay"},E.default.createElement("div",{id:"headerTeamName",className:"team__name"},this.props.teamDisplayName)),E.default.createElement("div",{id:"teamHeader",className:"team__header theme"},t,E.default.createElement("div",{id:"headerInfo",className:"header__info"},a,E.default.createElement("div",{id:"headerUsername",className:"user__name"},"@"+this.props.currentUser.username)),E.default.createElement("div",{id:"sidebarDropdownMenuContainer"},E.default.createElement(D.default,{ref:"dropdown",teamType:this.props.teamType,teamDisplayName:this.props.teamDisplayName,teamName:this.props.teamName,currentUser:this.props.currentUser})),e)}}]),t}(E.default.Component);t.default=A,A.defaultProps={teamDisplayName:"",teamDescription:"",teamType:""},A.propTypes={teamDisplayName:v.default.string,teamDescription:v.default.string,teamName:v.default.string,teamType:v.default.string,currentUser:v.default.object}},2495:function(e,t,a){"use strict";function n(e){var t=(0,d.getCurrentUser)(e),a=t.id,n=t.last_picture_update;return{userId:a,profilePicture:i.Client4.getProfilePictureUrl(a,n),status:(0,d.getStatusForUserId)(e,t.id)}}function l(e){return{actions:(0,r.bindActionCreators)({setStatus:o.setStatus},e)}}Object.defineProperty(t,"__esModule",{value:!0});var s=a(31),r=a(20),o=a(61),i=a(29),d=a(50),u=a(2496),c=function(e){return e&&e.__esModule?e:{default:e}}(u);t.default=(0,s.connect)(n,l)(c.default)},2496:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(6),s=n(l),r=a(4),o=n(r),i=a(5),d=n(i),u=a(7),c=n(u),h=a(8),f=n(h),m=a(2),p=n(m),g=a(1),v=n(g),C=a(40),E=a(17),M=a(9),_=a(2497),b=n(_),y=a(440),w=n(y),T=function(e){function t(){var e,a,n,l;(0,o.default)(this,t);for(var r=arguments.length,i=Array(r),d=0;d<r;d++)i[d]=arguments[d];return a=n=(0,c.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(i))),n.state={showDropdown:!1},n.onToggle=function(e){n.setState({showDropdown:e})},n.closeDropdown=function(){n.setState({showDropdown:!1})},n.setStatus=function(e){n.props.actions.setStatus({user_id:n.props.userId,status:e}),n.closeDropdown()},n.setOnline=function(e){e.preventDefault(),n.setStatus(M.UserStatuses.ONLINE)},n.setOffline=function(e){e.preventDefault(),n.setStatus(M.UserStatuses.OFFLINE)},n.setAway=function(e){e.preventDefault(),n.setStatus(M.UserStatuses.AWAY)},n.renderStatusOnlineAction=function(){return n.renderStatusAction(M.UserStatuses.ONLINE,n.setOnline)},n.renderStatusAwayAction=function(){return n.renderStatusAction(M.UserStatuses.AWAY,n.setAway)},n.renderStatusOfflineAction=function(){return n.renderStatusAction(M.UserStatuses.OFFLINE,n.setOffline)},n.renderProfilePicture=function(){return n.props.profilePicture?v.default.createElement("img",{className:"user__picture",src:n.props.profilePicture}):null},n.renderStatusAction=function(e,t){return v.default.createElement("li",{key:e},v.default.createElement("a",{id:"status"+e,href:"#",onClick:t},v.default.createElement(E.FormattedMessage,{id:"status_dropdown.set_"+e,defaultMessage:e})))},l=a,(0,c.default)(n,l)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=this.renderProfilePicture(),t=[this.renderStatusOnlineAction(),this.renderStatusAwayAction(),this.renderStatusOfflineAction()];return v.default.createElement(C.Dropdown,{id:"status-dropdown",open:this.state.showDropdown,onToggle:this.onToggle,style:this.props.style},v.default.createElement(b.default,{bsRole:"toggle"},v.default.createElement("div",{className:"status-wrapper status-selector"},e,v.default.createElement(w.default,{status:this.props.status}),v.default.createElement("span",{className:"status status-edit edit"},v.default.createElement("i",{className:"fa fa-caret-down"})))),v.default.createElement(C.Dropdown.Menu,{id:"editStatusMenu"},t))}}]),t}(v.default.Component);T.propTypes={style:p.default.object,status:p.default.string,userId:p.default.string.isRequired,profilePicture:p.default.string,actions:p.default.shape({setStatus:p.default.func.isRequired}).isRequired},t.default=T},2497:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(123),s=n(l),r=a(6),o=n(r),i=a(4),d=n(i),u=a(5),c=n(u),h=a(7),f=n(h),m=a(8),p=n(m),g=a(2),v=n(g),C=a(1),E=n(C),M=function(e){function t(){return(0,d.default)(this,t),(0,f.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=(0,s.default)(e,["children"]);return delete a.bsRole,delete a.bsClass,E.default.createElement("span",a,t)}}]),t}(E.default.PureComponent);M.propTypes={children:v.default.element},t.default=M},2498:function(e,t,a){"use strict";(function(e){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=a(6),r=l(s),o=a(4),i=l(o),d=a(5),u=l(d),c=a(7),h=l(c),f=a(8),m=l(f),p=a(0),g=l(p),v=a(2),C=l(v),E=a(1),M=l(E),_=a(40),b=a(47),y=l(b),w=a(17),T=a(44),N=a(56),S=n(N),k=a(35),L=l(k),D=a(25),A=l(D),P=a(436),U=l(P),O=a(9),I=a(78),R=a(87),F=n(R),x=a(16),H=n(x),j=a(2090),q=l(j),G=a(2097),B=l(G),K=a(2499),V=l(K),W=a(754),z=l(W),J=function(t){function a(e){(0,i.default)(this,a);var t=(0,h.default)(this,(a.__proto__||(0,r.default)(a)).call(this,e));return t.toggleDropdown=t.toggleDropdown.bind(t),t.handleAboutModal=t.handleAboutModal.bind(t),t.aboutModalDismissed=t.aboutModalDismissed.bind(t),t.showAccountSettingsModal=t.showAccountSettingsModal.bind(t),t.showAddUsersToTeamModal=t.showAddUsersToTeamModal.bind(t),t.hideAddUsersToTeamModal=t.hideAddUsersToTeamModal.bind(t),t.showInviteMemberModal=t.showInviteMemberModal.bind(t),t.showGetTeamInviteLinkModal=t.showGetTeamInviteLinkModal.bind(t),t.showTeamMembersModal=t.showTeamMembersModal.bind(t),t.hideTeamMembersModal=t.hideTeamMembersModal.bind(t),t.showShortcutsModal=t.showShortcutsModal.bind(t),t.onTeamChange=t.onTeamChange.bind(t),t.renderCustomEmojiLink=t.renderCustomEmojiLink.bind(t),t.handleClick=t.handleClick.bind(t),t.state={teamMembers:L.default.getMyTeamMembers(),teamListings:L.default.getTeamListings(),showAboutModal:!1,showDropdown:!1,showTeamMembersModal:!1,showAddUsersToTeamModal:!1},t}return(0,m.default)(a,t),(0,u.default)(a,[{key:"handleClick",value:function(e){U.default.isBusy()&&(U.default.emitChanged({action:O.WebrtcActionTypes.IN_PROGRESS}),e.preventDefault())}},{key:"toggleDropdown",value:function(e){if("boolean"==typeof e)return void this.setState({showDropdown:e});e&&e.preventDefault&&e.preventDefault(),this.setState({showDropdown:!this.state.showDropdown})}},{key:"handleAboutModal",value:function(e){e.preventDefault(),this.setState({showAboutModal:!0,showDropdown:!1})}},{key:"aboutModalDismissed",value:function(){this.setState({showAboutModal:!1})}},{key:"showAccountSettingsModal",value:function(e){e.preventDefault(),this.setState({showDropdown:!1}),S.showAccountSettingsModal()}},{key:"showShortcutsModal",value:function(e){e.preventDefault(),this.setState({showDropdown:!1}),S.showShortcutsModal()}},{key:"showAddUsersToTeamModal",value:function(e){e.preventDefault(),this.setState({showAddUsersToTeamModal:!0,showDropdown:!1})}},{key:"hideAddUsersToTeamModal",value:function(){this.setState({showAddUsersToTeamModal:!1})}},{key:"showInviteMemberModal",value:function(e){e.preventDefault(),this.setState({showDropdown:!1}),S.showInviteMemberModal()}},{key:"showGetTeamInviteLinkModal",value:function(e){e.preventDefault(),this.setState({showDropdown:!1}),S.showGetTeamInviteLinkModal()}},{key:"showTeamMembersModal",value:function(e){e.preventDefault(),this.setState({showTeamMembersModal:!0})}},{key:"hideTeamMembersModal",value:function(){this.setState({showTeamMembersModal:!1})}},{key:"componentDidMount",value:function(){L.default.addChangeListener(this.onTeamChange)}},{key:"onTeamChange",value:function(){this.setState({teamMembers:L.default.getMyTeamMembers(),teamListings:L.default.getTeamListings(),showDropdown:!1})}},{key:"componentWillUnmount",value:function(){(0,g.default)(y.default.findDOMNode(this.refs.dropdown)).off("hide.bs.dropdown"),L.default.removeChangeListener(this.onTeamChange)}},{key:"renderCustomEmojiLink",value:function(){return"true"===window.mm_config.EnableCustomEmoji&&H.canCreateCustomEmoji(this.props.currentUser)?M.default.createElement("li",null,M.default.createElement(T.Link,{id:"customEmoji",onClick:this.handleClick,to:"/"+this.props.teamName+"/emoji"},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.emoji",defaultMessage:"Custom Emoji"}))):null}},{key:"render",value:function(){var t=e.mm_config,a=this.props.currentUser,n="",l="",s="",r="",o="",i=!1,d=!1,u=null,c=null;if(!a)return null;null!=a&&(i=L.default.isTeamAdminForCurrentTeam()||A.default.isSystemAdminForCurrentUser(),d=A.default.isSystemAdminForCurrentUser(),l=M.default.createElement("li",null,M.default.createElement("button",{className:"style--none",id:"sendEmailInvite",onClick:this.showInviteMemberModal},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.inviteMember",defaultMessage:"Send Email Invite"}))),s=M.default.createElement("li",null,M.default.createElement("button",{className:"style--none",id:"addUsersToTeam",onClick:this.showAddUsersToTeamModal},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.addMemberToTeam",defaultMessage:"Add Members to Team"}))),this.props.teamType===O.Constants.OPEN_TEAM&&"true"===t.EnableUserCreation&&(n=M.default.createElement("li",null,M.default.createElement("button",{className:"style--none",id:"getTeamInviteLink",onClick:this.showGetTeamInviteLinkModal},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.teamLink",defaultMessage:"Get Team Invite Link"})))),"true"===e.window.mm_license.IsLicensed&&(t.RestrictTeamInvite!==O.Constants.PERMISSIONS_SYSTEM_ADMIN||d?t.RestrictTeamInvite!==O.Constants.PERMISSIONS_TEAM_ADMIN||i||(n=null,l=null,s=null):(n=null,l=null,s=null)));var h=M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.manageMembers",defaultMessage:"Manage Members"});i?u=M.default.createElement("li",null,M.default.createElement("button",{className:"style--none",id:"teamSettings","data-toggle":"modal","data-target":"#team_settings",onClick:this.toggleDropdown},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.teamSettings",defaultMessage:"Team Settings"}))):h=M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.viewMembers",defaultMessage:"View Members"}),r=M.default.createElement("li",null,M.default.createElement("button",{id:"manageMembers",className:"style--none",onClick:this.showTeamMembersModal},h)),("true"===t.EnableIncomingWebhooks||"true"===t.EnableOutgoingWebhooks||"true"===t.EnableCommands||"true"===t.EnableOAuthServiceProvider&&(d||"true"!==t.EnableOnlyAdminIntegrations))&&(i||"true"!==t.EnableOnlyAdminIntegrations)&&(c=M.default.createElement("li",null,M.default.createElement(T.Link,{id:"Integrations",to:"/"+this.props.teamName+"/integrations",onClick:this.handleClick},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.integrations",defaultMessage:"Integrations"})))),d&&(o=M.default.createElement("li",null,M.default.createElement(T.Link,{id:"systemConsole",to:"/admin_console",onClick:this.handleClick},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.console",defaultMessage:"System Console"}))));var f=[],m=!1;("true"===t.EnableTeamCreation||A.default.isSystemAdminForCurrentUser())&&f.push(M.default.createElement("li",{key:"newTeam_li"},M.default.createElement(T.Link,{id:"createTeam",key:"newTeam_a",to:"/create_team",onClick:this.handleClick},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.create",defaultMessage:"Create a New Team"}))));var p=this.state.teamMembers.reduce(function(e,t){return e[t.team_id]=!0,e},{});for(var g in this.state.teamListings)if(this.state.teamListings.hasOwnProperty(g)&&!p[g]){m=!0;break}m&&f.push(M.default.createElement("li",{key:"joinTeam_li"},M.default.createElement(T.Link,{id:"joinAnotherTeam",onClick:this.handleClick,to:"/select_team"},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.join",defaultMessage:"Join Another Team"})))),f.push(M.default.createElement("li",{key:"leaveTeam_li"},M.default.createElement("button",{className:"style--none",id:"leaveTeam",onClick:S.showLeaveTeamModal},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.leave",defaultMessage:"Leave Team"}))));var v=null;t.HelpLink&&(v=M.default.createElement("li",null,M.default.createElement(T.Link,{id:"helpLink",target:"_blank",rel:"noopener noreferrer",to:t.HelpLink},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.help",defaultMessage:"Help"}))));var C=null;t.ReportAProblemLink&&(C=M.default.createElement("li",null,M.default.createElement(T.Link,{id:"reportLink",target:"_blank",rel:"noopener noreferrer",to:t.ReportAProblemLink},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.report",defaultMessage:"Report a Problem"}))));var E=null;e.window.mm_config.AppDownloadLink&&!F.isMobileApp()&&(E=M.default.createElement("li",null,M.default.createElement(T.Link,{id:"nativeAppLink",target:"_blank",rel:"noopener noreferrer",to:(0,I.useSafeUrl)(e.window.mm_config.AppDownloadLink)},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.nativeApps",defaultMessage:"Download Apps"}))));var b=void 0;this.state.showTeamMembersModal&&(b=M.default.createElement(z.default,{onLoad:this.toggleDropdown,onHide:this.hideTeamMembersModal,isAdmin:i}));var y=void 0;this.state.showAddUsersToTeamModal&&(y=M.default.createElement(B.default,{onModalDismissed:this.hideAddUsersToTeamModal}));var N=M.default.createElement("li",null,M.default.createElement("button",{className:"style--none",id:"keyboardShortcuts",onClick:this.showShortcutsModal},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.keyboardShortcuts",defaultMessage:"Keyboard Shortcuts"}))),k=M.default.createElement("li",null,M.default.createElement("button",{className:"style--none",id:"accountSettings",onClick:this.showAccountSettingsModal},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.accountSettings",defaultMessage:"Account Settings"}))),D=M.default.createElement("li",null,M.default.createElement("button",{id:"about",className:"style--none",onClick:this.handleAboutModal},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.about",defaultMessage:"About Mattermost"}))),P=M.default.createElement("li",null,M.default.createElement("button",{className:"style--none",id:"logout",onClick:function(){return S.emitUserLoggedOutEvent()}},M.default.createElement(w.FormattedMessage,{id:"navbar_dropdown.logout",defaultMessage:"Logout"}))),U=this.renderCustomEmojiLink(),R=null;(l||n||s)&&(R=M.default.createElement("li",{className:"divider"}));var x=null;(u||r||f)&&(x=M.default.createElement("li",{className:"divider"}));var H=null;(c||U)&&(H=M.default.createElement("li",{className:"divider"}));var j=null;o&&(j=M.default.createElement("li",{className:"divider"}));var G=null;(v||C||E||D)&&(G=M.default.createElement("li",{className:"divider"}));var K=null;return P&&(K=M.default.createElement("li",{className:"divider"})),M.default.createElement(_.Dropdown,{id:"sidebar-header-dropdown",open:this.state.showDropdown,onToggle:this.toggleDropdown,className:"sidebar-header-dropdown",pullRight:!0},M.default.createElement(V.default,{bsRole:"toggle",onClick:this.toggleDropdown}),M.default.createElement(_.Dropdown.Menu,{id:"sidebarDropdownMenu"},k,R,l,n,s,x,u,r,f,H,c,U,j,o,G,v,N,C,E,D,K,P,b,M.default.createElement(q.default,{show:this.state.showAboutModal,onModalDismissed:this.aboutModalDismissed}),y))}}]),a}(M.default.Component);J.propTypes={teamType:C.default.string,teamDisplayName:C.default.string,teamName:C.default.string,currentUser:C.default.object},J.defaultProps={teamType:""},t.default=J}).call(t,a(22))},2499:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(6),s=n(l),r=a(4),o=n(r),i=a(5),d=n(i),u=a(7),c=n(u),h=a(8),f=n(h),m=a(2),p=n(m),g=a(1),v=n(g),C=a(40),E=a(17),M=a(9),_=n(M),b=function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,f.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=v.default.createElement(C.Tooltip,{id:"main-menu__tooltip"},v.default.createElement(E.FormattedMessage,{id:"sidebar.mainMenu",defaultMessage:"Main menu"}));return v.default.createElement(C.OverlayTrigger,{trigger:["hover","focus"],delayShow:_.default.OVERLAY_TIME_DELAY,placement:"right",overlay:e},v.default.createElement("button",{id:"sidebarHeaderDropdownButton",className:"sidebar-header-dropdown__toggle cursor--pointer style--none",onClick:this.props.onClick},v.default.createElement("span",{className:"sidebar-header-dropdown__icon",dangerouslySetInnerHTML:{__html:_.default.MENU_ICON}})))}}]),t}(v.default.PureComponent);b.propTypes={bsRole:p.default.oneOf(["toggle"]).isRequired,onClick:p.default.func.isRequired},t.default=b},2500:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(6),s=n(l),r=a(4),o=n(r),i=a(5),d=n(i),u=a(7),c=n(u),h=a(8),f=n(h),m=a(2),p=n(m),g=a(1),v=n(g),C=a(9),E=n(C),M=function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,f.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=E.default.UNREAD_ICON_SVG,t="none";return this.props.show&&(t="block"),v.default.createElement("div",{id:"unreadIndicator"+this.props.name,className:"nav-pills__unread-indicator "+this.props.extraClass,style:{display:t},onClick:this.props.onClick},this.props.content,v.default.createElement("span",{className:"icon icon__unread",dangerouslySetInnerHTML:{__html:e}}))}}]),t}(v.default.PureComponent);M.propTypes={onClick:p.default.func.isRequired,show:p.default.bool,extraClass:p.default.string,content:p.default.node,name:p.default.string},M.defaultProps={show:!1,extraClass:"",content:""},t.default=M},321:function(e,t,a){"use strict";(function(e){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=a(156),r=l(s),o=a(155),i=l(o),d=a(19),u=l(d),c=a(6),h=l(c),f=a(4),m=l(f),p=a(5),g=l(p),v=a(7),C=l(v),E=a(8),M=l(E),_=a(0),b=l(_),y=a(1),w=l(y),T=a(40),N=a(47),S=l(N),k=a(17),L=a(44),D=a(210),A=a(136),P=a(79),U=n(P),O=a(237),I=a(56),R=n(I),F=a(34),x=l(F),H=a(32),j=l(H),q=a(2080),G=l(q),B=a(119),K=l(B),V=a(38),W=l(V),z=a(35),J=l(z),Y=a(25),X=l(Y),Q=a(121),Z=n(Q),$=a(9),ee=a(16),te=n(ee),ae=a(790),ne=l(ae),le=a(2484),se=l(le),re=a(208),oe=l(re),ie=a(2485),de=l(ie),ue=a(2488),ce=l(ue),he=a(2490),fe=l(he),me=a(2494),pe=l(me),ge=a(440),ve=l(ge),Ce=a(742),Ee=l(Ce),Me=a(2500),_e=l(Me),be=$.Constants.Preferences,ye=$.Constants.TutorialSteps,we=W.default.dispatch,Te=W.default.getState,Ne=function(t){function a(t){(0,m.default)(this,a);var n=(0,C.default)(this,(a.__proto__||(0,h.default)(a)).call(this,t));n.getTotalUnreadCount=function(){var e=Z.getCountsStateFromStores(n.state.currentTeam,n.state.teamMembers,n.state.unreadCounts);return{msgs:e.messageCount,mentions:e.mentionCount}},n.getStateFromStores=function(){var e=j.default.getMyMembers(),t=J.default.getMyTeamMembers(),a=j.default.getCurrentId(),n=K.default.getInt(be.TUTORIAL_STEP,X.default.getCurrentId(),999),l=(0,A.getChannelsByCategory)(W.default.getState());return(0,u.default)({activeId:a,members:e,teamMembers:t},l,{unreadCounts:JSON.parse((0,i.default)(j.default.getUnreadCounts())),showTutorialTip:n===ye.CHANNEL_POPOVER,currentTeam:J.default.getCurrent(),currentUser:X.default.getCurrentUser(),townSquare:j.default.getByName($.Constants.DEFAULT_CHANNEL),offTopic:j.default.getByName($.Constants.OFFTOPIC_CHANNEL)})},n.onInChannelChange=function(){n.setState({inChannelChange:!n.state.inChannelChange})},n.onModalChange=function(e,t){n.showMoreDirectChannelsModal(X.default.getProfileListInChannel(t.channelId,!0,!1))},n.handleOpenMoreDirectChannelsModal=function(e){e.preventDefault(),n.state.showDirectChannelsModal?n.hideMoreDirectChannelsModal():n.showMoreDirectChannelsModal()},n.onChange=function(){n.state.currentTeam.id!==J.default.getCurrentId()&&j.default.clear(),n.setState(n.getStateFromStores()),n.updateTitle()},n.updateTitle=function(){var t=j.default.getCurrent();if(t&&n.state.currentTeam){var a="";null!=e.window.mm_config.SiteName&&(a=e.window.mm_config.SiteName);var l=t.display_name;if(t.type===$.Constants.DM_CHANNEL){var s=te.getDirectTeammate(t.id);null!=s&&(l=s.username)}var r=n.getTotalUnreadCount(),o=r.mentions>0?"("+r.mentions+") ":"",i=r.msgs>0?"* ":"";document.title=o+i+l+" - "+n.state.currentTeam.display_name+" "+a}},n.onScroll=function(){n.updateUnreadIndicators()},n.scrollToFirstUnreadChannel=function(){if(n.firstUnreadChannel){var e=(0,b.default)(S.default.findDOMNode(n.refs.container)),t=(0,b.default)(S.default.findDOMNode(n.refs[n.firstUnreadChannel])),a=e.scrollTop()+t.position().top-15;e.stop().animate({scrollTop:a},500,"swing")}},n.scrollToLastUnreadChannel=function(){if(n.lastUnreadChannel){var e=(0,b.default)(S.default.findDOMNode(n.refs.container)),t=(0,b.default)(S.default.findDOMNode(n.refs[n.lastUnreadChannel])),a=t.position().top+t.height(),l=e.scrollTop()+(a-e.height())+15;e.stop().animate({scrollTop:l},500,"swing")}},n.updateUnreadIndicators=function(){var e=(0,b.default)(S.default.findDOMNode(n.refs.container)),t=!1,a=!1;if(n.firstUnreadChannel){var l=(0,b.default)(S.default.findDOMNode(n.refs[n.firstUnreadChannel]));l.position().top+l.height()<15&&(t=!0)}if(n.lastUnreadChannel){(0,b.default)(S.default.findDOMNode(n.refs[n.lastUnreadChannel])).position().top>e.height()-15&&(a=!0)}n.setState({showTopUnread:t,showBottomUnread:a})},n.updateScrollbarOnChannelChange=function(e){var t=n.refs[e.name].getBoundingClientRect();(t.top-$.Constants.CHANNEL_SCROLL_ADJUSTMENT<0||t.top+t.height>n.refs.container.getBoundingClientRect().height)&&(n.refs.container.scrollTop=n.refs.container.scrollTop+(t.top-$.Constants.CHANNEL_SCROLL_ADJUSTMENT),(0,b.default)(".nav-pills__container").perfectScrollbar("update"))},n.navigateChannelShortcut=function(e){if(!e.altKey||e.shiftKey||e.keyCode!==$.Constants.KeyCodes.UP&&e.keyCode!==$.Constants.KeyCodes.DOWN)te.cmdOrCtrlPressed(e)&&e.shiftKey&&e.keyCode===$.Constants.KeyCodes.K&&n.handleOpenMoreDirectChannelsModal(e);else{if(e.preventDefault(),n.isSwitchingChannel)return;n.isSwitchingChannel=!0;for(var t=n.getDisplayedChannels(),a=n.state.activeId,l=-1,s=0;s<t.length;s++)t[s].id===a&&(l=s);var r=l;e.keyCode===$.Constants.KeyCodes.DOWN?r=l+1:e.keyCode===$.Constants.KeyCodes.UP&&(r=l-1);var o=t[te.mod(r,t.length)];U.goToChannel(o),n.updateScrollbarOnChannelChange(o),n.isSwitchingChannel=!1}},n.navigateUnreadChannelShortcut=function(e){if(e.altKey&&e.shiftKey&&(e.keyCode===$.Constants.KeyCodes.UP||e.keyCode===$.Constants.KeyCodes.DOWN)){if(e.preventDefault(),n.isSwitchingChannel)return;n.isSwitchingChannel=!0;for(var t=n.getDisplayedChannels(),a=n.state.activeId,l=-1,s=0;s<t.length;s++)t[s].id===a&&(l=s);var r=l,o=0,i=0;e.keyCode===$.Constants.KeyCodes.UP?i=-1:e.keyCode===$.Constants.KeyCodes.DOWN&&(i=1);for(var d=j.default.getUnreadCount(t[r].id);o<t.length&&0===d.msgs&&0===d.mentions;)r+=i,o++,r=te.mod(r,t.length),d=j.default.getUnreadCount(t[r].id);if(0!==d.msgs||0!==d.mentions){var u=t[r];U.goToChannel(u),n.updateScrollbarOnChannelChange(u)}n.isSwitchingChannel=!1}},n.getDisplayedChannels=function(){return n.state.favoriteChannels.concat(n.state.publicChannels).concat(n.state.privateChannels).concat(n.state.directAndGroupChannels)},n.handleLeavePublicChannel=function(e,t){e.preventDefault(),U.leaveChannel(t.id),(0,O.trackEvent)("ui","ui_public_channel_x_button_clicked")},n.handleLeavePrivateChannel=function(e,t){e.preventDefault(),R.showLeavePrivateChannelModal(t),(0,O.trackEvent)("ui","ui_private_channel_x_button_clicked")},n.handleLeaveDirectChannel=function(e,t){if(e.preventDefault(),!n.isLeaving.get(t.id)){n.isLeaving.set(t.id,!0);var a=void 0,l=void 0;t.type===$.Constants.DM_CHANNEL?(a=t.teammate_id,l=$.Constants.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW):(a=t.id,l=$.Constants.Preferences.CATEGORY_GROUP_CHANNEL_SHOW);var s=X.default.getCurrentId();(0,D.savePreferences)(s,[{user_id:s,category:l,name:a,value:"false"}])(we,Te).then(function(){n.isLeaving.set(t.id,!1)}),Z.isFavoriteChannel(t)&&U.unmarkFavorite(t.id),n.setState(n.getStateFromStores()),(0,O.trackEvent)("ui","ui_direct_channel_x_button_clicked")}t.id===n.state.activeId&&(n.closedDirectChannel=!0,L.browserHistory.push("/"+n.state.currentTeam.name+"/channels/town-square"))},n.showMoreChannelsModal=function(){n.setState({showMoreChannelsModal:!0}),(0,O.trackEvent)("ui","ui_channels_more_public")},n.hideMoreChannelsModal=function(){n.setState({showMoreChannelsModal:!1})},n.showNewChannelModal=function(e){n.setState({newChannelModalType:e})},n.hideNewChannelModal=function(){n.setState({newChannelModalType:""})},n.showMoreDirectChannelsModal=function(e){(0,O.trackEvent)("ui","ui_channels_more_direct"),n.setState({showDirectChannelsModal:!0,startingUsers:e})},n.hideMoreDirectChannelsModal=function(){n.setState({showDirectChannelsModal:!1,startingUsers:null})},n.openLeftSidebar=function(){te.isMobile()&&setTimeout(function(){document.querySelector(".app__body .inner-wrap").classList.add("move--right"),document.querySelector(".app__body .sidebar--left").classList.add("move--right")})},n.openQuickSwitcher=function(e){e.preventDefault(),x.default.handleViewAction({type:$.ActionTypes.TOGGLE_QUICK_SWITCH_MODAL})},n.createTutorialTip=function(){var e=[],t=$.Constants.DEFAULT_CHANNEL_UI_NAME;n.state.townSquare&&(t=n.state.townSquare.display_name);var a=$.Constants.OFFTOPIC_CHANNEL_UI_NAME;return n.state.offTopic&&(a=n.state.offTopic.display_name),e.push(w.default.createElement("div",null,w.default.createElement(k.FormattedHTMLMessage,{id:"sidebar.tutorialScreen1",defaultMessage:"<h4>Channels</h4><p><strong>Channels</strong> organize conversations across different topics. They’re open to everyone on your team. To send private communications use <strong>Direct Messages</strong> for a single person or <strong>Private Channels</strong> for multiple people.</p>"}))),e.push(w.default.createElement("div",null,w.default.createElement(k.FormattedHTMLMessage,{id:"sidebar.tutorialScreen2",defaultMessage:'<h4>"{townsquare}" and "{offtopic}" channels</h4> <p>Here are two public channels to start:</p> <p><strong>{townsquare}</strong> is a place for team-wide communication. Everyone in your team is a member of this channel.</p> <p><strong>{offtopic}</strong> is a place for fun and humor outside of work-related channels. You and your team can decide what other channels to create.</p>',values:{townsquare:t,offtopic:a}}))),e.push(w.default.createElement("div",null,w.default.createElement(k.FormattedHTMLMessage,{id:"sidebar.tutorialScreen3",defaultMessage:'<h4>Creating and Joining Channels</h4> <p>Click <strong>"More..."</strong> to create a new channel or join an existing one.</p> <p>You can also create a new public or private channel by clicking the <strong>"+" symbol</strong> next to the public or private channel header.</p>'}))),w.default.createElement(Ee.default,{placement:"right",screens:e,overlayClass:"tip-overlay--sidebar",diagnosticsTag:"tutorial_tip_2_channels"})},n.createChannelElement=function(e,t,a,l){var s=n.state.members,r=n.state.activeId,o=s[e.id],d=n.state.unreadCounts[e.id]||{msgs:0,mentions:0},u=void 0,c="";e.id===r&&(c="active");var h="sidebar-item",f=!1;o&&(u=d.msgs+d.mentions,f=u>0||o.mention_count>0),f&&(h+=" unread-title",e.id!==r&&(n.firstUnreadChannel||(n.firstUnreadChannel=e.name),n.lastUnreadChannel=e.name));var m=null;o?d.mentions&&(m=w.default.createElement("span",{className:"badge"},d.mentions),n.badgesActive=!0):n.state.loadingDMChannel===t&&e.type===$.Constants.DM_CHANNEL&&(m=w.default.createElement("img",{className:"channel-loading-gif pull-right",src:oe.default})),d.mentions>0&&(h+=" has-badge");var p=null,g=$.Constants.GLOBE_ICON_SVG,v=$.Constants.LOCK_ICON_SVG;p=e.type===$.Constants.OPEN_CHANNEL?w.default.createElement("span",{className:"icon icon__globe",dangerouslySetInnerHTML:{__html:g}}):e.type===$.Constants.PRIVATE_CHANNEL?w.default.createElement("span",{className:"icon icon__lock",dangerouslySetInnerHTML:{__html:v}}):e.type===$.Constants.GM_CHANNEL?w.default.createElement("div",{className:"status status--group"},X.default.getProfileListInChannel(e.id,!0).length):w.default.createElement(ve.default,{type:"avatar",status:e.status});var C=null,E=w.default.createElement(T.Tooltip,{id:"remove-dm-tooltip"},w.default.createElement(k.FormattedMessage,{id:"sidebar.removeList",defaultMessage:"Remove from list"}));e.type!==$.Constants.OPEN_CHANNEL&&e.type!==$.Constants.PRIVATE_CHANNEL||(E=w.default.createElement(T.Tooltip,{id:"remove-dm-tooltip"},w.default.createElement(k.FormattedMessage,{id:"sidebar.leave",defaultMessage:"Leave channel"}))),l&&!m&&(C=w.default.createElement(T.OverlayTrigger,{trigger:["hover","focus"],delayShow:1e3,placement:"top",overlay:E},w.default.createElement("span",{onClick:function(t){return l(t,e)},className:"btn-close"},"×")),h+=" has-close");var M=null;n.state.showTutorialTip&&e.name===$.Constants.DEFAULT_CHANNEL&&(M=n.createTutorialTip(),n.openLeftSidebar());var _="";_=e.fake?"/"+n.state.currentTeam.name+"/channels/"+e.name+"?fakechannel="+encodeURIComponent((0,i.default)(e)):"/"+n.state.currentTeam.name+"/channels/"+e.name;var b=e.display_name;return w.default.createElement("li",{key:e.name,ref:e.name,className:c},w.default.createElement(L.Link,{to:_,className:h,onClick:n.trackChannelSelectedEvent},p,w.default.createElement("span",{className:"sidebar-item__name"},b),m,C),M)},n.trackChannelSelectedEvent=function(){(0,O.trackEvent)("ui","ui_channel_selected")},n.badgesActive=!1,n.firstUnreadChannel=null,n.lastUnreadChannel=null,n.isLeaving=new r.default,n.isSwitchingChannel=!1,n.closedDirectChannel=!1;var l=n.getStateFromStores();return l.newChannelModalType="",l.showDirectChannelsModal=!1,l.showMoreChannelsModal=!1,l.loadingDMChannel=-1,l.inChannelChange=!1,n.state=l,n}return(0,M.default)(a,t),(0,g.default)(a,[{key:"componentDidMount",value:function(){j.default.addChangeListener(this.onChange),X.default.addChangeListener(this.onChange),X.default.addInTeamChangeListener(this.onChange),X.default.addInChannelChangeListener(this.onInChannelChange),X.default.addStatusesChangeListener(this.onChange),J.default.addChangeListener(this.onChange),K.default.addChangeListener(this.onChange),G.default.addModalListener($.ActionTypes.TOGGLE_DM_MODAL,this.onModalChange),this.updateTitle(),this.updateUnreadIndicators(),document.addEventListener("keydown",this.navigateChannelShortcut),document.addEventListener("keydown",this.navigateUnreadChannelShortcut)}},{key:"shouldComponentUpdate",value:function(e,t){return!te.areObjectsEqual(t,this.state)}},{key:"componentDidUpdate",value:function(e,t){this.updateTitle(),this.updateUnreadIndicators(),te.isMobile()||(0,b.default)(".sidebar--left .nav-pills__container").perfectScrollbar(),this.state.currentTeam!==t.currentTeam&&(this.refs.container.scrollTop=0,(0,b.default)(".nav-pills__container").perfectScrollbar("update")),this.state.activeId!==t.activeId&&(this.closedDirectChannel?this.closedDirectChannel=!1:((0,b.default)(".app__body .inner-wrap").removeClass("move--right"),(0,b.default)(".app__body .sidebar--left").removeClass("move--right"),(0,b.default)(".multi-teams .team-sidebar").removeClass("move--right")))}},{key:"componentWillUnmount",value:function(){j.default.removeChangeListener(this.onChange),X.default.removeChangeListener(this.onChange),X.default.removeInTeamChangeListener(this.onChange),X.default.removeInChannelChangeListener(this.onChange),X.default.removeStatusesChangeListener(this.onChange),J.default.removeChangeListener(this.onChange),K.default.removeChangeListener(this.onChange),G.default.removeModalListener($.ActionTypes.TOGGLE_DM_MODAL,this.onModalChange),document.removeEventListener("keydown",this.navigateChannelShortcut),document.removeEventListener("keydown",this.navigateUnreadChannelShortcut)}},{key:"render",value:function(){var t=this,a=$.Constants.SWITCH_CHANNEL_ICON_SVG;if(null==this.state.currentTeam||null==this.state.currentUser)return w.default.createElement("div",null);this.lastBadgesActive=this.badgesActive,this.badgesActive=!1,this.firstUnreadChannel=null,this.lastUnreadChannel=null;var n=this.state.favoriteChannels.map(function(a,n,l){if(a.type===$.Constants.DM_CHANNEL||a.type===$.Constants.GM_CHANNEL)return t.createChannelElement(a,n,l,t.handleLeaveDirectChannel);if("true"===e.window.mm_config.EnableXToLeaveChannelsFromLHS){if(a.type===$.Constants.OPEN_CHANNEL&&a.name!==$.Constants.DEFAULT_CHANNEL)return t.createChannelElement(a,n,l,t.handleLeavePublicChannel);if(a.type===$.Constants.PRIVATE_CHANNEL)return t.createChannelElement(a,n,l,t.handleLeavePrivateChannel)}return t.createChannelElement(a)}),l=this.state.publicChannels.map(function(a,n,l){return"true"!==e.window.mm_config.EnableXToLeaveChannelsFromLHS||a.name===$.Constants.DEFAULT_CHANNEL?t.createChannelElement(a):t.createChannelElement(a,n,l,t.handleLeavePublicChannel)}),s=this.state.privateChannels.map(function(a,n,l){return"true"!==e.window.mm_config.EnableXToLeaveChannelsFromLHS?t.createChannelElement(a):t.createChannelElement(a,n,l,t.handleLeavePrivateChannel)}),r=this.state.directAndGroupChannels.map(function(e,a,n){return t.createChannelElement(e,a,n,t.handleLeaveDirectChannel)});if(this.lastBadgesActive!==this.badgesActive){var o=document.createElement("link");o.type="image/x-icon",o.rel="shortcut icon",o.id="favicon",this.badgesActive?o.href=se.default:o.href=ne.default;var i=document.getElementsByTagName("head")[0],d=document.getElementById("favicon");d&&i.removeChild(d),i.appendChild(o)}var u=w.default.createElement("li",{key:"more"},w.default.createElement("button",{id:"moreDirectMessage",className:"nav-more cursor--pointer style--none btn--block",onClick:this.handleOpenMoreDirectChannelsModal},w.default.createElement(k.FormattedMessage,{id:"sidebar.moreElips",defaultMessage:"More..."}))),c=!1;""!==this.state.newChannelModalType&&(c=!0);var h=w.default.createElement(T.Tooltip,{id:"new-channel-tooltip"},w.default.createElement(k.FormattedMessage,{id:"sidebar.createChannel",defaultMessage:"Create new public channel"})),f=w.default.createElement(T.Tooltip,{id:"new-group-tooltip"},w.default.createElement(k.FormattedMessage,{id:"sidebar.createGroup",defaultMessage:"Create new private channel"})),m=w.default.createElement(T.Tooltip,{id:"new-group-tooltip",className:"hidden-xs"},w.default.createElement(k.FormattedMessage,{id:"sidebar.createDirectMessage",defaultMessage:"Create new direct message"})),p=w.default.createElement(k.FormattedMessage,{id:"sidebar.unreads",defaultMessage:"More unreads"}),g=w.default.createElement(k.FormattedMessage,{id:"sidebar.unreads",defaultMessage:"More unreads"}),v=J.default.isTeamAdminForCurrentTeam(),C=X.default.isSystemAdminForCurrentUser(),E=w.default.createElement(T.OverlayTrigger,{trigger:["hover","focus"],delayShow:500,placement:"top",overlay:h},w.default.createElement("button",{id:"createPublicChannel",className:"add-channel-btn cursor--pointer style--none",onClick:this.showNewChannelModal.bind(this,$.Constants.OPEN_CHANNEL)},"+")),M=w.default.createElement(T.OverlayTrigger,{trigger:["hover","focus"],delayShow:500,placement:"top",overlay:f},w.default.createElement("button",{id:"createPrivateChannel",className:"add-channel-btn cursor--pointer style--none",onClick:this.showNewChannelModal.bind(this,$.Constants.PRIVATE_CHANNEL)},"+"));Z.showCreateOption($.Constants.OPEN_CHANNEL,v,C)||(E=null);var _=w.default.createElement(T.OverlayTrigger,{className:"hidden-xs",delayShow:500,placement:"top",overlay:m},w.default.createElement("button",{className:"add-channel-btn cursor--pointer style--none",onClick:this.handleOpenMoreDirectChannelsModal},"+"));Z.showCreateOption($.Constants.PRIVATE_CHANNEL,v,C)||(M=null);var b=void 0;this.state.showDirectChannelsModal&&(b=w.default.createElement(ce.default,{onModalDismissed:this.hideMoreDirectChannelsModal,startingUsers:this.state.startingUsers}));var y=void 0;this.state.showMoreChannelsModal&&(y=w.default.createElement(de.default,{onModalDismissed:this.hideMoreChannelsModal,handleNewChannel:function(){t.hideMoreChannelsModal(),t.showNewChannelModal($.Constants.OPEN_CHANNEL)}}));var N="quick_switch_modal.channelsShortcut.windows",S="- CTRL+K";te.isMac()&&(N="quick_switch_modal.channelsShortcut.mac",S="- ⌘K");var L=w.default.createElement("span",{className:"switch__shortcut hidden-xs"},w.default.createElement(k.FormattedMessage,{id:N,defaultMessage:S}));return w.default.createElement("div",{className:"sidebar--left",id:"sidebar-left",key:"sidebar-left"},w.default.createElement(fe.default,{show:c,channelType:this.state.newChannelModalType,onModalDismissed:this.hideNewChannelModal}),b,y,w.default.createElement(pe.default,{teamDisplayName:this.state.currentTeam.display_name,teamDescription:this.state.currentTeam.description,teamName:this.state.currentTeam.name,teamType:this.state.currentTeam.type,currentUser:this.state.currentUser}),w.default.createElement(_e.default,{name:"Top",show:this.state.showTopUnread,onClick:this.scrollToFirstUnreadChannel,extraClass:"nav-pills__unread-indicator-top",text:p}),w.default.createElement(_e.default,{name:"Bottom",show:this.state.showBottomUnread,onClick:this.scrollToLastUnreadChannel,extraClass:"nav-pills__unread-indicator-bottom",text:g}),w.default.createElement("div",{id:"sidebarChannelContainer",ref:"container",className:"nav-pills__container",onScroll:this.onScroll},0!==n.length&&w.default.createElement("ul",{className:"nav nav-pills nav-stacked"},w.default.createElement("li",null,w.default.createElement("h4",{id:"favoriteChannel"},w.default.createElement(k.FormattedMessage,{id:"sidebar.favorite",defaultMessage:"FAVORITE CHANNELS"}))),n),w.default.createElement("ul",{className:"nav nav-pills nav-stacked"},w.default.createElement("li",null,w.default.createElement("h4",{id:"publicChannel"},w.default.createElement(k.FormattedMessage,{id:"sidebar.channels",defaultMessage:"PUBLIC CHANNELS"}),E)),l,w.default.createElement("li",null,w.default.createElement("button",{id:"sidebarChannelsMore",className:"nav-more cursor--pointer style--none btn--block",onClick:this.showMoreChannelsModal},w.default.createElement(k.FormattedMessage,{id:"sidebar.moreElips",defaultMessage:"More..."})))),w.default.createElement("ul",{className:"nav nav-pills nav-stacked"},w.default.createElement("li",null,w.default.createElement("h4",{id:"privateChannel"},w.default.createElement(k.FormattedMessage,{id:"sidebar.pg",defaultMessage:"PRIVATE CHANNELS"}),M)),s),w.default.createElement("ul",{className:"nav nav-pills nav-stacked"},w.default.createElement("li",null,w.default.createElement("h4",{id:"directChannel"},w.default.createElement(k.FormattedMessage,{id:"sidebar.direct",defaultMessage:"DIRECT MESSAGES"}),_)),r,u)),w.default.createElement("div",{className:"sidebar__switcher"},w.default.createElement("button",{id:"sidebarSwitcherButton",className:"btn btn-link",onClick:this.openQuickSwitcher},w.default.createElement("span",{className:"icon icon__switch",dangerouslySetInnerHTML:{__html:a}}),w.default.createElement(k.FormattedMessage,{id:"channel_switch_modal.title",defaultMessage:"Switch Channels"}),L)))}}]),a}(w.default.Component);t.default=Ne}).call(t,a(22))}});
//# sourceMappingURL=0.9c7e2c030757ccb2d809.js.map