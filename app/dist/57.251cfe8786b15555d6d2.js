webpackJsonp([57],{2107:function(e,a,t){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(a,"__esModule",{value:!0});var l=t(6),s=r(l),o=t(4),d=r(o),i=t(5),n=r(i),m=t(7),u=r(m),p=t(8),c=r(p),f=t(2),w=r(f),h=t(1),E=r(h),_=t(17),v=t(734),g=t(69),b=t(16),P=function(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t]);return a.default=e,a}(b),M=t(2085),y=r(M),D=function(a){function t(e){(0,d.default)(this,t);var a=(0,u.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.submit=a.submit.bind(a),a.preSubmit=a.preSubmit.bind(a),a.state={passwordError:"",ldapError:"",ldapPasswordError:"",serverError:"",showMfa:!1},a}return(0,c.default)(t,a),(0,n.default)(t,[{key:"preSubmit",value:function(e){var a=this;e.preventDefault();var t={passwordError:"",ldapError:"",ldapPasswordError:"",serverError:""},r=this.refs.emailpassword.value;if(!r)return t.passwordError=P.localizeMessage("claim.email_to_ldap.pwdError","Please enter your password."),void this.setState(t);var l=this.refs.ldapid.value.trim();if(!l)return t.ldapError=P.localizeMessage("claim.email_to_ldap.ldapIdError","Please enter your AD/LDAP ID."),void this.setState(t);var s=this.refs.ldappassword.value;if(!s)return t.ldapPasswordError=P.localizeMessage("claim.email_to_ldap.ldapPasswordError","Please enter your AD/LDAP password."),void this.setState(t);t.password=r,t.ldapId=l,t.ldapPassword=s,this.setState(t),(0,g.checkMfa)(this.props.email,function(e){e?a.setState({showMfa:!0}):a.submit(a.props.email,r,"",l,s)},function(e){a.setState({error:e.message})})}},{key:"submit",value:function(e,a,t,r,l){var s=this;(0,v.emailToLdap)(e,a,t,r||this.state.ldapId,l||this.state.ldapPassword,function(e){e.follow_link&&(window.location.href=e.follow_link)},function(e){switch(e.id){case"ent.ldap.do_login.user_not_registered.app_error":case"ent.ldap.do_login.user_filtered.app_error":case"ent.ldap.do_login.matched_to_many_users.app_error":s.setState({ldapError:e.message,showMfa:!1});break;case"ent.ldap.do_login.invalid_password.app_error":s.setState({ldapPasswordError:e.message,showMfa:!1});break;case"api.user.check_user_password.invalid.app_error":s.setState({passwordError:e.message,showMfa:!1});break;default:s.setState({serverError:e.message,showMfa:!1})}})}},{key:"render",value:function(){var a=null,t="form-group";this.state.serverError&&(a=E.default.createElement("div",{className:"form-group has-error"},E.default.createElement("label",{className:"control-label"},this.state.serverError)),t+=" has-error");var r=null,l="form-group";this.state.passwordError&&(r=E.default.createElement("div",{className:"form-group has-error"},E.default.createElement("label",{className:"control-label"},this.state.passwordError)),l+=" has-error");var s=null,o="form-group";this.state.ldapError&&(s=E.default.createElement("div",{className:"form-group has-error"},E.default.createElement("label",{className:"control-label"},this.state.ldapError)),o+=" has-error");var d=null,i="form-group";this.state.ldapPasswordError&&(d=E.default.createElement("div",{className:"form-group has-error"},E.default.createElement("label",{className:"control-label"},this.state.ldapPasswordError)),i+=" has-error");var n=void 0;n=e.window.mm_config.LdapLoginFieldName?e.window.mm_config.LdapLoginFieldName:P.localizeMessage("claim.email_to_ldap.ldapId","AD/LDAP ID");var m=void 0;m=e.window.mm_config.LdapPasswordFieldName?e.window.mm_config.LdapPasswordFieldName:P.localizeMessage("claim.email_to_ldap.ldapPwd","AD/LDAP Password");var u=void 0;return u=this.state.showMfa?E.default.createElement(y.default,{loginId:this.props.email,password:this.state.password,submit:this.submit}):E.default.createElement("form",{onSubmit:this.preSubmit,className:t},E.default.createElement("p",null,E.default.createElement(_.FormattedMessage,{id:"claim.email_to_ldap.ssoType",defaultMessage:"Upon claiming your account, you will only be able to login with AD/LDAP"})),E.default.createElement("p",null,E.default.createElement(_.FormattedMessage,{id:"claim.email_to_ldap.ssoNote",defaultMessage:"You must already have a valid AD/LDAP account"})),E.default.createElement("p",null,E.default.createElement(_.FormattedMessage,{id:"claim.email_to_ldap.enterPwd",defaultMessage:"Enter the password for your {site} email account",values:{site:e.window.mm_config.SiteName}})),E.default.createElement("input",{type:"text",style:{display:"none"},name:"fakeusernameremembered"}),E.default.createElement("div",{className:l},E.default.createElement("input",{type:"password",className:"form-control",name:"emailPassword",ref:"emailpassword",autoComplete:"off",placeholder:P.localizeMessage("claim.email_to_ldap.pwd","Password"),spellCheck:"false"})),r,E.default.createElement("p",null,E.default.createElement(_.FormattedMessage,{id:"claim.email_to_ldap.enterLdapPwd",defaultMessage:"Enter the ID and password for your AD/LDAP account"})),E.default.createElement("div",{className:o},E.default.createElement("input",{type:"text",className:"form-control",name:"ldapId",ref:"ldapid",autoComplete:"off",placeholder:n,spellCheck:"false"})),s,E.default.createElement("div",{className:i},E.default.createElement("input",{type:"password",className:"form-control",name:"ldapPassword",ref:"ldappassword",autoComplete:"off",placeholder:m,spellCheck:"false"})),d,E.default.createElement("button",{type:"submit",className:"btn btn-primary"},E.default.createElement(_.FormattedMessage,{id:"claim.email_to_ldap.switchTo",defaultMessage:"Switch account to AD/LDAP"})),a),E.default.createElement("div",null,E.default.createElement("h3",null,E.default.createElement(_.FormattedMessage,{id:"claim.email_to_ldap.title",defaultMessage:"Switch Email/Password Account to AD/LDAP"})),u)}}]),t}(E.default.Component);a.default=D,D.defaultProps={},D.propTypes={email:w.default.string}}).call(a,t(22))}});
//# sourceMappingURL=57.251cfe8786b15555d6d2.js.map