webpackJsonp([55],{2106:function(e,a,r){"use strict";(function(e){function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(a,"__esModule",{value:!0});var s=r(6),l=t(s),o=r(4),d=t(o),i=r(5),m=t(i),n=r(7),u=t(n),c=r(8),p=t(c),f=r(2),w=t(f),h=r(1),E=t(h),v=r(17),_=r(69),g=r(16),P=function(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r]);return a.default=e,a}(g),b=r(2085),M=t(b),N=function(a){function r(e){(0,d.default)(this,r);var a=(0,u.default)(this,(r.__proto__||(0,l.default)(r)).call(this,e));return a.submit=a.submit.bind(a),a.preSubmit=a.preSubmit.bind(a),a.state={passwordError:"",confirmError:"",ldapPasswordError:"",serverError:""},a}return(0,p.default)(r,a),(0,m.default)(r,[{key:"preSubmit",value:function(e){var a=this;e.preventDefault();var r={passwordError:"",confirmError:"",ldapPasswordError:"",serverError:""},t=this.refs.ldappassword.value;if(!t)return r.ldapPasswordError=P.localizeMessage("claim.ldap_to_email.ldapPasswordError","Please enter your AD/LDAP password."),void this.setState(r);var s=this.refs.password.value;if(!s)return r.passwordError=P.localizeMessage("claim.ldap_to_email.pwdError","Please enter your password."),void this.setState(r);var l=P.isValidPassword(s);if(""!==l)return void this.setState({passwordError:l});var o=this.refs.passwordconfirm.value;if(!o||s!==o)return r.confirmError=P.localizeMessage("claim.ldap_to_email.pwdNotMatch","Passwords do not match."),void this.setState(r);r.password=s,r.ldapPassword=t,this.setState(r),(0,_.checkMfa)(this.props.email,function(e){e?a.setState({showMfa:!0}):a.submit(a.props.email,s,"",t)},function(e){a.setState({error:e.message})})}},{key:"submit",value:function(e,a,r,t){var s=this;(0,_.switchFromLdapToEmail)(this.props.email,a,r,t||this.state.ldapPassword,null,function(e){if(e.id.startsWith("model.user.is_valid.pwd"))s.setState({passwordError:e.message,showMfa:!1});else switch(e.id){case"ent.ldap.do_login.invalid_password.app_error":s.setState({ldapPasswordError:e.message,showMfa:!1});break;default:s.setState({serverError:e.message,showMfa:!1})}})}},{key:"render",value:function(){var a=null,r="form-group";this.state.serverError&&(a=E.default.createElement("div",{className:"form-group has-error"},E.default.createElement("label",{className:"control-label"},this.state.serverError)),r+=" has-error");var t=null,s="form-group";this.state.passwordError&&(t=E.default.createElement("div",{className:"form-group has-error"},E.default.createElement("label",{className:"control-label"},this.state.passwordError)),s+=" has-error");var l=null,o="form-group";this.state.ldapPasswordError&&(l=E.default.createElement("div",{className:"form-group has-error"},E.default.createElement("label",{className:"control-label"},this.state.ldapPasswordError)),o+=" has-error");var d=null,i="form-group";this.state.confirmError&&(d=E.default.createElement("div",{className:"form-group has-error"},E.default.createElement("label",{className:"control-label"},this.state.confirmError)),i+=" has-error");var m=void 0;m=e.window.mm_config.LdapPasswordFieldName?e.window.mm_config.LdapPasswordFieldName:P.localizeMessage("claim.ldap_to_email.ldapPwd","AD/LDAP Password");var n=void 0;return n=this.state.showMfa?E.default.createElement(M.default,{loginId:this.props.email,password:this.state.password,submit:this.submit}):E.default.createElement("form",{onSubmit:this.preSubmit,className:r},E.default.createElement("p",null,E.default.createElement(v.FormattedMessage,{id:"claim.ldap_to_email.email",defaultMessage:"After switching your authentication method, you will use {email} to login. Your AD/LDAP credentials will no longer allow access to Mattermost.",values:{email:this.props.email}})),E.default.createElement("p",null,E.default.createElement(v.FormattedMessage,{id:"claim.ldap_to_email.enterLdapPwd",defaultMessage:"{ldapPassword}:",values:{ldapPassword:m}})),E.default.createElement("div",{className:o},E.default.createElement("input",{type:"password",className:"form-control",name:"ldapPassword",ref:"ldappassword",placeholder:m,spellCheck:"false"})),l,E.default.createElement("p",null,E.default.createElement(v.FormattedMessage,{id:"claim.ldap_to_email.enterPwd",defaultMessage:"New email login password:"})),E.default.createElement("div",{className:s},E.default.createElement("input",{type:"password",className:"form-control",name:"password",ref:"password",placeholder:P.localizeMessage("claim.ldap_to_email.pwd","Password"),spellCheck:"false"})),t,E.default.createElement("div",{className:i},E.default.createElement("input",{type:"password",className:"form-control",name:"passwordconfirm",ref:"passwordconfirm",placeholder:P.localizeMessage("claim.ldap_to_email.confirm","Confirm Password"),spellCheck:"false"})),d,E.default.createElement("button",{type:"submit",className:"btn btn-primary"},E.default.createElement(v.FormattedMessage,{id:"claim.ldap_to_email.switchTo",defaultMessage:"Switch account to email/password"})),a),E.default.createElement("div",null,E.default.createElement("h3",null,E.default.createElement(v.FormattedMessage,{id:"claim.ldap_to_email.title",defaultMessage:"Switch AD/LDAP Account to Email/Password"})),n)}}]),r}(E.default.Component);a.default=N,N.defaultProps={},N.propTypes={email:w.default.string}}).call(a,r(22))}});
//# sourceMappingURL=55.4f30db2d783e667acca1.js.map